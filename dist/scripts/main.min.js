(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';




















var _app = require('app');var _app2 = _interopRequireDefault(_app);
var _features = require('features');function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };} /*!
                                                                                                                                   *
                                                                                                                                   *  Web Starter Kit
                                                                                                                                   *  Copyright 2015 Google Inc. All rights reserved.
                                                                                                                                   *
                                                                                                                                   *  Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                   *  you may not use this file except in compliance with the License.
                                                                                                                                   *  You may obtain a copy of the License at
                                                                                                                                   *
                                                                                                                                   *    https://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                   *
                                                                                                                                   *  Unless required by applicable law or agreed to in writing, software
                                                                                                                                   *  distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                   *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                   *  See the License for the specific language governing permissions and
                                                                                                                                   *  limitations under the License
                                                                                                                                   *
                                                                                                                                   */ /* eslint-env browser */ // jshint esversion: 6
(function () {'use strict'; // Check to make sure service workers are supported in the current browser,
  // and that the current page is accessed from a secure origin. Using a
  // service worker from an insecure origin will trigger JS console errors. See
  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features
  var isLocalhost = Boolean(window.location.hostname === 'localhost' || // [::1] is the IPv6 localhost address.
  window.location.hostname === '[::1]' || // 127.0.0.1/8 is considered localhost for IPv4.
  window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)); // TODO SW-2 - register the service worker
  if ('serviceWorker' in navigator && (window.location.protocol === 'https:' || isLocalhost)) {navigator.serviceWorker.register('service-worker.js').then(function (registration) {// updatefound is fired if service-worker.js changes.
      registration.onupdatefound = function () {// updatefound is also fired the very first time the SW is installed,
        // and there's no need to prompt for a reload at that point.
        // So check here to see if the page is already controlled,
        // i.e. whether there's an existing service worker.
        if (navigator.serviceWorker.controller) {// The updatefound event implies that registration.installing is set:
          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event
          var installingWorker = registration.installing;

          installingWorker.onstatechange = function () {
            switch (installingWorker.state) {
              case 'installed':
                // At this point, the old content will have been purged and the
                // fresh content will have been added to the cache.
                // It's the perfect time to display a "New content is
                // available; please refresh." message in the page's interface.
                break;

              case 'redundant':
                throw new Error('The installing ' +
                'service worker became redundant.');

              default:
              // Ignore
            }
          };
        }
      };
    }).catch(function (e) {
      console.error('Error during service worker registration:', e);
    });
  }

  // Your custom JavaScript goes here
  var app = new _app2.default();
  document.addEventListener('DOMContentLoaded', function (e) {
    if (!(0, _features.hasPrerequisites)()) {
      // TODO make this something nicer than an alert, e.g. a panel in the app
      window.alert('This browser is missing some required features');
      return;
    }
    app.install();
    app.run();
  });

})();

},{"app":2,"features":6}],2:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}(); /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 */

var _cart = require('cart');var _cart2 = _interopRequireDefault(_cart);
var _idbStorage = require('idb-storage');var _idbStorage2 = _interopRequireDefault(_idbStorage);

var _cartView = require('cart-view');var _cartView2 = _interopRequireDefault(_cartView);
var _shopView = require('shop-view');var _shopView2 = _interopRequireDefault(_shopView);
var _paymentForm = require('payment-form');var _paymentForm2 = _interopRequireDefault(_paymentForm);
var _paymentApi = require('payment-api');var _paymentApi2 = _interopRequireDefault(_paymentApi);
var _confirmationView = require('confirmation-view');var _confirmationView2 = _interopRequireDefault(_confirmationView);
var _headerController = require('header-controller');var _headerController2 = _interopRequireDefault(_headerController);
var _urlTools = require('url-tools');
var _features = require('features');var features = _interopRequireWildcard(_features);function _interopRequireWildcard(obj) {if (obj && obj.__esModule) {return obj;} else {var newObj = {};if (obj != null) {for (var key in obj) {if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];}}newObj.default = obj;return newObj;}}function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}var

App = function () {

  function App() {_classCallCheck(this, App);
    this._storage = features.hasIndexedDB ? new _idbStorage2.default() : new _idbStorage2.default();
    this._cart = new _cart2.default(this._storage, this._cartChanged.bind(this));
    this._cartView = new _cartView2.default(this._cart);
    this._shopView = new _shopView2.default(this._cart);
    this._paymentForm = new _paymentForm2.default(this._cart);
    this._confirmationView = new _confirmationView2.default();
    this._header = new _headerController2.default();
    this._hashChangeListener = this._handleHashChange.bind(this);
  }_createClass(App, [{ key: 'install', value: function install()

    {
      window.addEventListener('hashchange', this._hashChangeListener);
      this._shopView.install();
      this._cartView.install();
    } }, { key: 'uninstall', value: function uninstall()

    {
      window.removeEventListener('hashchange', this._hashChangeListener);
    }

    // Manage element visibility (hide the cart when store is selected and vice versa)
  }, { key: 'run', value: function run()















































    {var _this = this;
      (0, _urlTools.replaceLocationHash)('shop');
      this._cart.load().then(function () {
        _this._shopView.render();
        _this._cartView.render();
        _this._updateCartCountDisplay();
        _this.selection = 'shop';
      });
    }

    // Handle hashChange, manage history (#store or #cart, maybe #pay)
  }, { key: '_handleHashChange', value: function _handleHashChange(event) {
      if (!event.newURL) return;
      var index = event.newURL.lastIndexOf('#');
      if (index < 0) return;
      var sel = event.newURL.substr(index + 1);
      this.selection = sel;
    } }, { key: '_cartChanged', value: function _cartChanged(

    details) {
      if (details.action === 'load') return;
      this._updateCartCountDisplay();
      this._cartView.render();
      this._cart.save();
    } }, { key: '_updateCartCountDisplay', value: function _updateCartCountDisplay()

    {
      this._header.count = this._cart.count;
    }
    // Testing hooks
  }, { key: 'selection', set: function set(sel) {var _this2 = this;switch (sel) {case 'shop':case 'cart':this._header.selection = sel;this._shopView.visible = sel === 'shop';this._cartView.visible = sel !== 'shop';this._paymentForm.visible = false;this._confirmationView.visible = false;break;case 'pay':this._header.selection = 'cart';this._cartView.visible = true;this._confirmationView.visible = false;this._paymentForm.visible = false;var _promise = void 0; // TODO PAY-2.1 - detect feature
          if (window.PaymentRequest) {var api = new _paymentApi2.default();_promise = api.checkout(this._cart);} else {this._paymentForm.visible = true;_promise = this._paymentForm.checkout(this._cart);}_promise.then(function () {_this2._cart.reset();(0, _urlTools.replaceLocationHash)('shop');_this2.selection = 'shop';alert('Thanks for shopping! Payment successfully complete :)');}).catch(function () {alert('Sorry, payment failed :(');});break;case 'confirm':this._header.selection = 'cart';this._cartView.visible = false;this._paymentForm.visible = false;this._confirmationView.visible = true;break;}} }, { key: 'headerController', set: function set(obj) {this._header = obj;
    } }, { key: 'cart', get: function get()

    {
      return this._cart;
    } }, { key: 'storage', get: function get()

    {
      return this._storage;
    }, set: function set(

    adaptor) {
      this._storage = adaptor;
      this._cart.storage = adaptor;
    } }]);return App;}();exports.default = App;

},{"cart":4,"cart-view":3,"confirmation-view":5,"features":6,"header-controller":7,"idb-storage":8,"payment-api":10,"payment-form":11,"shop-view":14,"url-tools":16}],3:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();















var _view = require('view');var _view2 = _interopRequireDefault(_view);
var _urlTools = require('url-tools');
var _products = require('products');function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          */var CartView = function (_View) {_inherits(CartView, _View);function CartView(cart) {var containerId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'cart';_classCallCheck(this, CartView);var _this = _possibleConstructorReturn(this, (CartView.__proto__ || Object.getPrototypeOf(CartView)).call(this, containerId));_this._cart = cart;_this._element = 'tr';_this._elementClass = 'product';_this._clickHandler = null;_this._tbody = _this._container.querySelector('tbody');_this._checkoutBtn = document.getElementById('checkoutBtn');return _this;}_createClass(CartView, [{ key: 'install', value: function install() {
      this._clickHandler = this._handleClick.bind(this);
      this._container.addEventListener('click', this._clickHandler, true);
      // Checkout button switches hash to "pay", will cause the form to open
      this._checkoutBtn.addEventListener('click', this._goToPayment.bind(this));
    } }, { key: 'render', value: function render()

    {
      // Remove existing products
      var itemRows = this._tbody.querySelectorAll(this.itemSelector);
      for (var i = 0; i < itemRows.length; i++) {
        this._tbody.removeChild(itemRows[i]);
      }var _iteratorNormalCompletion = true;var _didIteratorError = false;var _iteratorError = undefined;try {
        for (var _iterator = this._cart.cart[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {var item = _step.value;
          var product = (0, _products.findProduct)(item.sku);
          var placeholder = document.createElement('tbody');
          placeholder.innerHTML = '<tr class="product" data-sku="' + product.sku + '">\n        <td class="mdl-data-table__cell-non-numeric">' +
          product.title + '</td>\n        <td>' +
          item.quantity + '</td>\n        <td>Rp. ' +
          product.price + '</td>\n        <td><button class="mdl-button mdl-button--colored mdl-js-button\n              mdl-js-ripple-effect mdl-button--accent delete"\n              data-sku="' +


          product.sku + '" data-action="remove">\n              <i class="material-icons">delete</i>remove</button>\n        </td>\n      </tr>';



          this._tbody.appendChild(placeholder.firstElementChild); // WARN: no ie8
        }
        // Add the total price
      } catch (err) {_didIteratorError = true;_iteratorError = err;} finally {try {if (!_iteratorNormalCompletion && _iterator.return) {_iterator.return();}} finally {if (_didIteratorError) {throw _iteratorError;}}}this.updateTotal();
    } }, { key: 'updateTotal', value: function updateTotal()

    {
      document.getElementById('cart-total').innerText = 'Rp. ' + this._cart.total;
    } }, { key: 'removeFromView', value: function removeFromView(

    sku) {
      var row = this._tbody.querySelector('tr[data-sku=' + sku + ']');
      if (row) {
        row.parentNode.removeChild(row);
      }
      this.updateTotal();
    } }, { key: '_goToPayment', value: function _goToPayment()

    {
      (0, _urlTools.pushLocationHash)('pay');
    } }, { key: '_handleClick', value: function _handleClick(

    event) {
      if (event.target.dataset) {
        var sku = event.target.dataset.sku;
        var action = event.target.dataset.action;
        if (sku && action == 'remove') {
          var product = this._cart.findItem(sku);
          this._cart.remove(product);
          this.removeFromView(sku);
        }
      }
    }

    // utility for unit testing (used in counting the number of elements)
  }, { key: 'itemSelector', get: function get() {
      return this._element + '.' + this._elementClass + '[data-sku]';
    } }, { key: 'cart', set: function set(

    cart) {
      this._cart = cart;
    } }]);return CartView;}(_view2.default);exports.default = CartView;

},{"products":13,"url-tools":16,"view":17}],4:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });exports.LineItem = exports.CART_EVENT = undefined;var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}(); /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   */

//jshint esversion: 6

var _products = require('products');function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}

var CART_EVENT = exports.CART_EVENT = "cartchange";var

Cart = function () {
  function Cart(adaptor, changeCallback) {_classCallCheck(this, Cart);
    this.items = [];
    this._storage = adaptor;
    this._loading = false;
    this._callback = changeCallback; // used to report changes back to the app
  }_createClass(Cart, [{ key: 'findItem', value: function findItem(

    sku) {
      return this.items.find(function (item) {return item.sku === sku;});
    } }, { key: 'add', value: function add(

    product) {var quantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      if (quantity < 0 || !product) return null;
      var item = this.findItem(product.sku);
      if (item) {
        item.quantity += quantity;
      } else {
        item = new LineItem(product, quantity);
        this.items.push(item);
      }
      this._reportChange('add', product, quantity);
      return item;
    } }, { key: 'remove', value: function remove(

    product) {
      var index = this.items.findIndex(function (item) {return item.sku === product.sku;});
      if (index >= 0) {
        this.items.splice(index, 1);
      }
      this._reportChange('remove', product);
    } }, { key: 'change', value: function change(

    product, quantity) {
      var item = this.findItem(product.sku);
      if (quantity <= 0) {
        this.remove(item);
        this._reportChange('remove', product);
        return null;
      } else {
        item.quantity = quantity;
        this._reportChange('change', product, quantity);
        return item;
      }
    } }, { key: 'reset', value: function reset()

    {
      this.items = [];
      this._reportChange('reset');
    } }, { key: 'save', value: function save()

























    {
      if (!this._storage) return;
      return this._storage.save(this.items.map(function (item) {return item.savedValue;}));
    } }, { key: 'load', value: function load()

    {var _this = this;
      if (!this._storage) return;
      this._loading = true;
      return this._storage.load().then(function (loadedItems) {
        _this.items = loadedItems.map(function (s) {var li = new LineItem();li.savedValue = s;return li;});
      }).catch(function (e) {
        _this.items = [];
      }).then(function () {
        _this._loading = false;
        _this._reportChange('load');
        return _this.items;
      });
    } }, { key: '_reportChange', value: function _reportChange(

    action, product, quantity) {
      if (this._loading) return; // don't spam the app with events
      var details = { 'action': action, 'total': this.total };
      if (product) details.sku = product.sku;
      if (quantity) details.quantity = quantity;
      if (this._callback) this._callback(details);
    } }, { key: 'length', get: function get() {return this.items.length;} }, { key: 'count', get: function get() {var count = 0;var _iteratorNormalCompletion = true;var _didIteratorError = false;var _iteratorError = undefined;try {for (var _iterator = this.items[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {var item = _step.value;count += item.quantity;}} catch (err) {_didIteratorError = true;_iteratorError = err;} finally {try {if (!_iteratorNormalCompletion && _iterator.return) {_iterator.return();}} finally {if (_didIteratorError) {throw _iteratorError;}}}return count;} }, { key: 'total', get: function get() {var total = 0;var _iteratorNormalCompletion2 = true;var _didIteratorError2 = false;var _iteratorError2 = undefined;try {for (var _iterator2 = this.items[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {var item = _step2.value;total += item.total;}} catch (err) {_didIteratorError2 = true;_iteratorError2 = err;} finally {try {if (!_iteratorNormalCompletion2 && _iterator2.return) {_iterator2.return();}} finally {if (_didIteratorError2) {throw _iteratorError2;}}}return total;} }, { key: 'cart', get: function get() {return this.items;} }]);return Cart;}();exports.default = Cart;var


LineItem = exports.LineItem = function () {
  function LineItem(product, quantity) {_classCallCheck(this, LineItem);
    if (product == null) {
      this._sku = null;
      this._price = this._quantity = 0;
    } else {
      this._sku = product.sku;
      this._price = product.price;
      this._quantity = quantity;
    }
  }_createClass(LineItem, [{ key: 'sku', get: function get()

    {
      return this._sku;
    } }, { key: 'price', get: function get()

    {
      return this._price;
    } }, { key: 'total', get: function get()

    {
      return this._quantity * this._price;
    } }, { key: 'quantity', get: function get()

    {
      return this._quantity;
    }, set: function set(

    value) {
      this._quantity = value < 0 ? 0 : value;
    }

    // Only save minimal information (to conserve space & prevent spoofing)
  }, { key: 'savedValue', get: function get() {
      return { sku: this._sku, qty: this._quantity };
    }, set: function set(

    value) {
      var product = (0, _products.findProduct)(value.sku);
      if (!product) throw new Error('SKU not found: ' + value.sku);
      this._sku = value.sku;
      this._quantity = value.qty;
      this._price = product.price;
    } }, { key: 'storage', set: function set(

    adaptor) {
      this._storage = adaptor;
    } }]);return LineItem;}();

},{"products":13}],5:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();















var _view = require('view');var _view2 = _interopRequireDefault(_view);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             */var ConfirmationView = function (_View) {_inherits(ConfirmationView, _View);function ConfirmationView() {var containerId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'confirmation';_classCallCheck(this, ConfirmationView);var _this = _possibleConstructorReturn(this, (ConfirmationView.__proto__ || Object.getPrototypeOf(ConfirmationView)).call(this, containerId));_this._requestData = '';_this._responseData = '';_this._requestDiv = document.getElementById('requestData');_this._responseDiv = document.getElementById('responseData'); // this._clickHandler = null;
    // this._checkoutBtn = document.getElementById('checkoutBtn');
    return _this;}_createClass(ConfirmationView, [{ key: 'install', value: function install() {// this._clickHandler = this._handleClick.bind(this);
      // this._container.addEventListener('click', this._clickHandler, true);
    } }, { key: 'render', value: function render()
    {
      this._requestDiv.innerText = this._requestData;
      this._responseDiv.innerText = this._responseData;
    } }, { key: 'requestData', set: function set(

    value) {
      this._requestData = value === null ? '' : value;
      this._render();
    } }, { key: 'responseData', set: function set(

    value) {
      this._responseData = value === null ? '' : value;
      this._render();
    } }]);return ConfirmationView;}(_view2.default);exports.default = ConfirmationView;

},{"view":17}],6:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });exports.















hasPrerequisites = hasPrerequisites;exports.






hasLocalStorage = hasLocalStorage;exports.



hasIndexedDB = hasIndexedDB;exports.



hasPaymentRequest = hasPaymentRequest; /*
                                       Copyright 2016 Google Inc.
                                       
                                       Licensed under the Apache License, Version 2.0 (the "License");
                                       you may not use this file except in compliance with the License.
                                       You may obtain a copy of the License at
                                       
                                           http://www.apache.org/licenses/LICENSE-2.0
                                       
                                       Unless required by applicable law or agreed to in writing, software
                                       distributed under the License is distributed on an "AS IS" BASIS,
                                       WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                       See the License for the specific language governing permissions and
                                       limitations under the License.
                                       */function hasPrerequisites() {var hasStorage = hasLocalStorage() || hasIndexedDB(); // firstElementChild not in ie8
  var hasFirstElementChild = 'firstElementChild' in document;return hasStorage & hasFirstElementChild;}function hasLocalStorage() {return 'LocalStorage' in window;}function hasIndexedDB() {return 'indexedDB' in window;}function hasPaymentRequest() {return 'PaymentRequest' in window;}

},{}],7:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */

//jshint esversion: 6
var HeaderController = function () {

  function HeaderController() {var containerId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'headers';_classCallCheck(this, HeaderController);
    this._containerId = containerId;
    this._selection = 'shop';
    this._count = 0;
  }_createClass(HeaderController, [{ key: 'selection', get: function get()

    {
      return this._selection;
    }, set: function set(

    newValue) {
      if (newValue != 'shop' && newValue != 'cart') return;
      if (newValue == this._selection) return;
      this._selection = newValue;

      // Now update the UI
      var container = document.getElementById(this._containerId);
      // Only two kinds of links, so flip active
      var links = container.querySelectorAll('a.mdl-navigation__link');
      for (var i = 0; i < links.length; i++) {
        links[i].classList.toggle('is-active');
      }
    } }, { key: 'count', get: function get()

    {
      return this._count;
    }, set: function set(

    newCount) {
      if (this._count == newCount) return;
      // TODO use a badge instead
      var label = newCount === 0 ? '' : ' (' + newCount + ' items)';
      this._count = newCount;
      var spans = document.querySelectorAll('#' + this._containerId + ' a[href="#cart"]');
      for (var i = 0; i < spans.length; i++) {
        spans[i].innerText = 'Cart' + label;
      }
    } }]);return HeaderController;}();exports.default = HeaderController;

},{}],8:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}(); /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 */

var _idb = require('idb');var idb = _interopRequireWildcard(_idb);function _interopRequireWildcard(obj) {if (obj && obj.__esModule) {return obj;} else {var newObj = {};if (obj != null) {for (var key in obj) {if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];}}newObj.default = obj;return newObj;}}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}

var CART_STORE = 'cart';
var RW = 'readwrite';var

IDBStorage = function () {

  function IDBStorage() {var id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'mfs-cart-items';_classCallCheck(this, IDBStorage);
    this._id = id;
    this._open();
  }

  /* Takes an array of items and writes JSON to local storage */_createClass(IDBStorage, [{ key: 'save', value: function save(
    items) {
      return this._dbPromise.then(function (db) {
        var tx = db.transaction(CART_STORE, RW);
        var store = tx.objectStore(CART_STORE);
        return store.clear().then(function () {
          var addAll = items.map(function (item) {
            return store.add({ sku: item.sku, qty: item.qty });
          });
          return Promise.all(addAll);
        }).then(function () {
          return tx.complete;
        });
      });
    } }, { key: 'load', value: function load()

    {
      return this._dbPromise.then(function (db) {
        return db.transaction(CART_STORE, RW).
        objectStore(CART_STORE).
        getAll();
      });
    } }, { key: 'delete', value: function _delete()

    {

    } //    localStorage.removeItem(this._id);

    // Returns a promise with the total number of records saved
  }, { key: 'count', value: function count() {
      return this._dbPromise.then(function (db) {
        var tx = db.transaction(CART_STORE);
        return tx.objectStore(CART_STORE).count();
      });
    }

    // Testing use only, will close the dabase but renders the adaptor unusable
  }, { key: '_close', value: function _close() {var _this = this;
      return this._dbPromise.then(function (db) {
        var closePromise = db.close();
        _this._dbPromise = null;
        return closePromise;
      });
    } }, { key: '_open', value: function _open()

    {
      return this._dbPromise = idb.open(this._id, 1, function (upgradeDB) {
        upgradeDB.createObjectStore(CART_STORE, { autoIncrement: true });
      });
    }

    // testing hooks so we can test w/o wrecking the stored data
  }, { key: 'key', set: function set(value) {var _this2 = this;
      if (value === this._id) return;
      this._close().then(function () {
        _this2._id = value;
        _this2._open();
      });
    }, get: function get()

    {
      return this._id;
    } }, { key: 'storage', get: function get()

    {
      return this._dbPromise;
    } }]);return IDBStorage;}();exports.default = IDBStorage;

},{"idb":18}],9:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });exports.default =



















sendToServer; /*
              Copyright 2016 Google Inc.
              
              Licensed under the Apache License, Version 2.0 (the "License");
              you may not use this file except in compliance with the License.
              You may obtain a copy of the License at
              
                  http://www.apache.org/licenses/LICENSE-2.0
              
              Unless required by applicable law or agreed to in writing, software
              distributed under the License is distributed on an "AS IS" BASIS,
              WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
              See the License for the specific language governing permissions and
              limitations under the License.
              */ /*
                  * Simple server fetch function that only send a request to /checkout
                  * and returns `true` or throws an exception.
                  */function sendToServer(data) {return fetch('/checkout/', { method: 'POST', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) }).then(function (res) {if (res.status !== 200) {throw new Error('Payment failure (id ' + res.status + ')');}return true;});}

},{}],10:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}(); /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 */

var _merchantServer = require('merchant-server');var _merchantServer2 = _interopRequireDefault(_merchantServer);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}

var SHIPPING_OPTIONS = {
  us: [
  {
    id: 'standard',
    label: 'Standard Shipping',
    price: 0 },

  {
    id: 'express',
    label: 'Express Shipping',
    price: 10 }],


  international: [
  {
    id: 'international',
    label: 'International Shipping',
    price: 15 }] };var




PaymentAPIWrapper = function () {function PaymentAPIWrapper() {_classCallCheck(this, PaymentAPIWrapper);}_createClass(PaymentAPIWrapper, [{ key: 'checkout',

    /*
                                                                                                                                                             * Given a cart set up with an order, gets payment authorization.
                                                                                                                                                             * Returns a promise that resolves when payment is complete, this
                                                                                                                                                             * has a data object you can pass to the back-end payment server.
                                                                                                                                                             */value: function checkout(
    cart) {
      var request = this.buildPaymentRequest(cart);
      var response = void 0;
      // Show UI then continue with user payment info

      // TODO PAY-5 - display the PaymentRequest
      return request.show().
      then(function (r) {
        // The UI will show a spinner to the user until
        // `request.complete()` is called.
        response = r;
        var data = r.toJSON();
        console.log(data);
        return data;
      }).
      then(function (data) {
        return (0, _merchantServer2.default)(data);
      }).
      then(function () {
        response.complete('success');
        return response;
      }).
      catch(function (e) {
        if (response) {
          console.error(e);
          response.complete('fail');
        } else if (e.code !== e.ABORT_ERR) {
          console.error(e);
          throw e;
        } else {
          return null;
        }
      });
    }

    /*
       * Creates a PaymentRequest object including the event handlers used to
       * update the payment details as the user makes choices.
       */ }, { key: 'buildPaymentRequest', value: function buildPaymentRequest(
    cart) {var _this = this;
      // Supported payment instruments
      var supportedInstruments = [
      // TODO PAY-3 - add a list of accepted payment methods
      {
        supportedMethods: ['basic-card'],
        data: {
          supportedNetworks: ['visa', 'mastercard', 'amex',
          'jcb', 'diners', 'discover', 'mir', 'unionpay'] } }];




      // Payment options
      var paymentOptions = {

        // TODO PAY-6.1 - allow shipping options
        requestShipping: true,
        // TODO PAY-8 - Add payment options
        requestPayerEmail: true,
        requestPayerPhone: true,
        requestPayerName: true };



      var shippingOptions = [];
      var selectedOption = null;

      var details = this.buildPaymentDetails(cart, shippingOptions, selectedOption);

      // TODO PAY-2.2 - initialize the PaymentRequest object
      var request = new PaymentRequest(supportedInstruments, details, paymentOptions);

      // TODO PAY-7.1 - add `shippingaddresschange` event handler
      request.addEventListener('shippingaddresschange', function (e) {
        e.updateWith(function (_) {
          // Get the shipping options and select the least expensive
          shippingOptions = _this.optionsForCountry(request.shippingAddress.country);
          selectedOption = shippingOptions[0].id;
          var details = _this.buildPaymentDetails(cart, shippingOptions, selectedOption);
          return Promise.resolve(details);
        }());
      });
      // TODO PAY-7.2 - add `shippingoptionchange` event handler
      request.addEventListener('shippingoptionchange', function (e) {
        e.updateWith(function (_) {
          selectedOption = request.shippingOption;
          var details = _this.buildPaymentDetails(cart, shippingOptions, selectedOption);
          return Promise.resolve(details);
        }());
      });
      return request;
    }

    /*
       * Creates the PaymentDetails dictionary inside the PaymentRequest.
       * This can change as the user selects shipping options.
       */ }, { key: 'buildPaymentDetails', value: function buildPaymentDetails(
    cart, shippingOptions, shippingOptionId) {

      // TODO PAY-4.2 - define the display items
      var displayItems = cart.cart.map(function (item) {
        return {
          label: item.sku + ': ' + item.quantity + 'x Rp. ' + item.price,
          amount: { currency: 'IDR', value: String(item.total) } };

      });

      var total = cart.total;

      // TODO PAY-6.3 - allow shipping options
      var displayedShippingOptions = [];
      if (shippingOptions.length > 0) {
        var selectedOption = shippingOptions.find(function (option) {
          return option.id === shippingOptionId;
        });
        displayedShippingOptions = shippingOptions.map(function (option) {
          return {
            id: option.id,
            label: option.label,
            amount: { currency: 'IDR', value: String(option.price) },
            selected: option.id === shippingOptionId };

        });
        if (selectedOption) total += selectedOption.price;
      }

      var details = {
        displayItems: displayItems,
        total: {
          label: 'Total due',
          amount: { currency: 'IDR', value: String(total) } },

        // TODO PAY-6.2 - allow shipping options
        shippingOptions: displayedShippingOptions };


      return details;
    }

    /*
       * Utility function to extract the correct shipping options for a country.
       */ }, { key: 'optionsForCountry', value: function optionsForCountry(
    country) {
      country = country.toLowerCase();
      if (!country || !SHIPPING_OPTIONS.hasOwnProperty(country)) {
        country = 'international';
      }
      var options = SHIPPING_OPTIONS[country];
      // Sort by price, lowest first
      options.sort(function (a, b) {
        return a.price - b.price;
      });
      return options;
    } }]);return PaymentAPIWrapper;}();exports.default = PaymentAPIWrapper;

},{"merchant-server":9}],11:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();















var _view = require('view');var _view2 = _interopRequireDefault(_view);
var _merchantServer = require('merchant-server');var _merchantServer2 = _interopRequireDefault(_merchantServer);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */var PaymentForm = function (_View) {_inherits(PaymentForm, _View);function PaymentForm(cart, confirmationView) {var containerId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'payment';_classCallCheck(this, PaymentForm);var _this = _possibleConstructorReturn(this, (PaymentForm.__proto__ || Object.getPrototypeOf(PaymentForm)).call(this, containerId));_this._checkoutForm = document.getElementById('payment_form');_this._cart = cart;_this._confirmationView = confirmationView;_this._promise = null;return _this;} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Performs the checkout using the form. Returns a promise that resolves when
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * the user checks out.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 */_createClass(PaymentForm, [{ key: 'checkout', value: function checkout() {var _this2 = this; // TODO how do we handle cart abandonment?
      var self = this;
      this.visible = true;
      this._promise = new Promise(function (resolve, reject) {
        _this2._checkoutForm.addEventListener('submit', function temp(event) {
          event.preventDefault();
          var data = new FormData(event.target);
          self._showRequest(data);
          return Promise.resolve(data).
          then(_merchantServer2.default).
          then(function (json) {
            self._showResponse(json);
            resolve(json);
          }).
          catch(function (e) {return reject(e);}).
          then(function () {return self._checkoutForm.removeEventListener('submit', temp);});
        });
      });
      return this._promise;
    } }, { key: 'abort', value: function abort()

    {
      this._promise.reject('aborted');
    } }, { key: '_showRequest', value: function _showRequest(

    formData) {
      if (this._confirmationView) {
        this._confirmationView.requestData = this._toJSON(formData);
      }
    } }, { key: '_showResponse', value: function _showResponse(

    json) {
      if (this._confirmationView) {
        this._confirmationView.responseData = json;
      }
    } }, { key: '_toJSON', value: function _toJSON(

    formData) {
      var obj = {};var _iteratorNormalCompletion = true;var _didIteratorError = false;var _iteratorError = undefined;try {
        for (var _iterator = formData[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {var entry = _step.value;
          obj[entry.key] = entry.value;
        }} catch (err) {_didIteratorError = true;_iteratorError = err;} finally {try {if (!_iteratorNormalCompletion && _iterator.return) {_iterator.return();}} finally {if (_didIteratorError) {throw _iteratorError;}}}
      return JSON.stringify(obj);
    } }]);return PaymentForm;}(_view2.default);exports.default = PaymentForm;

},{"merchant-server":9,"view":17}],12:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */

//jshint esversion: 6
var
Product = function () {

  function Product(sku, title, price, image) {var description = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : '';_classCallCheck(this, Product);
    this._sku = sku;
    this._title = title;
    this._price = price;
    this._image = image;
    this._description = description;
  }_createClass(Product, [{ key: 'sku', get: function get()

    {
      return this._sku;
    } }, { key: 'title', get: function get()

    {
      return this._title;
    } }, { key: 'price', get: function get()

    {
      return this._price;
    } }, { key: 'image', get: function get()

    {
      return this._image;
    } }, { key: 'description', get: function get()

    {
      return this._description;
    } }]);return Product;}();exports.default = Product;

},{}],13:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });exports.products = undefined;exports.








































findProduct = findProduct;var _product = require('product');var _product2 = _interopRequireDefault(_product);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };} //   constructor (sku, title, price, image, description='') {
// Normally you would get these from a server
var products = exports.products = [new _product2.default('Batik1', 'Batik 1', 25000, 'batik1.jpg', 'Ini adalah batik yang pertama bukan kedua.'), new _product2.default('Batik2', 'Batik 2', 33000, 'batik2.jpg', 'Yang ini namanya batik kedua bukan orang kedua.'), new _product2.default('Batik3', 'Batik 3', 22000, 'batik3.jpg', 'Ini batik yang ketiga walau semua tidak suka menjadi yang ketiga.'), new _product2.default('Batik4', 'Batik 4', 45000, 'batik4.jpg', 'Batik 4 sering disebut juga yang keempat meski tak dianggap.'), new _product2.default('Batik5', 'Batik 5', 50000, 'batik5.jpg', 'Sebagai yang kelima batik ini konsisten menjadi secret admire.'), new _product2.default('Batik6', 'Batik 6', 60000, 'batik6.jpg', 'Ini batik yang keenam meski tak punya pengalaman menjalin hubungan.'), new _product2.default('Batik7', 'Batik 7', 65000, 'batik7.jpg', 'Batik ini Ketujuh dengan semua keputusanmu.'), new _product2.default('Batik8', 'Batik 8', 70000, 'batik8.jpg', 'Ini batik kedelapan walau bukan yang pertama semoga ini yang terbaik'), new _product2.default('Batik9', 'Batik 9', 200000, 'batik9.jpg', 'Meski ini merupakan batik termahal namun kupastikan kamu terakhir yang memilikiku')]; /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         */function findProduct(sku) {var searchRange = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : products;return searchRange.find(function (product) {return product.sku === sku;});}

},{"product":12}],14:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();















var _view = require('view');var _view2 = _interopRequireDefault(_view);
var _products = require('products');
var _snackbar = require('snackbar');var _snackbar2 = _interopRequireDefault(_snackbar);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             */var ShopView = function (_View) {_inherits(ShopView, _View);function ShopView(cart) {var productSelection = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _products.products;var containerId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'shop';_classCallCheck(this, ShopView);var _this = _possibleConstructorReturn(this, (ShopView.__proto__ || Object.getPrototypeOf(ShopView)).call(this, containerId, true));_this._cart = cart;_this._products = productSelection;_this._element = 'div';_this._elementClass = 'product';_this._addHandler = null;return _this;}_createClass(ShopView, [{ key: 'install', value: function install() {// Capture add events (clicks) as they bubble up. Only add once.
      this._addHandler = this._handleProductClick.bind(this);
      this._container.addEventListener('click', this._addHandler, false);
    } }, { key: 'render', value: function render()

    {
      this._container.innerHTML = ''; // remove all children
      var _iteratorNormalCompletion = true;var _didIteratorError = false;var _iteratorError = undefined;try {for (var _iterator = this._products[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {var product = _step.value;
          var placeholder = document.createElement('div');
          placeholder.innerHTML = '<div class="mdl-cell mdl-card mdl-shadow--4dp portfolio-card product">\n        <div class="mdl-card__media">\n          <img class="article-image" src=" images/products/' +

          product.image + '" border="0" alt="">\n        </div>\n        <div class="mdl-card__title">\n          <h2 class="mdl-card__title-text">' +


          product.title + '</h2>\n        </div>\n        <div class="mdl-card__supporting-text">\n          ' +


          product.description + '\n        </div>\n        <div class="mdl-card__actions mdl-card--border">\n          <button class="mdl-button mdl-button--colored mdl-js-button\n            mdl-js-ripple-effect mdl-button--accent add-to-cart"\n            data-sku="' +




          product.sku + '">\n            <i class="material-icons">add_shopping_cart</i>Add to Cart\n          </button>\n        </div>\n      </div>';




          this._container.appendChild(placeholder.firstElementChild); // WARN: no ie8
        }} catch (err) {_didIteratorError = true;_iteratorError = err;} finally {try {if (!_iteratorNormalCompletion && _iterator.return) {_iterator.return();}} finally {if (_didIteratorError) {throw _iteratorError;}}}
    } }, { key: '_handleProductClick', value: function _handleProductClick(

    event) {
      event.preventDefault();
      // MDL inserts an animated span as a child of the button; it gets the click.
      // We may need to look at the parent to find the button.
      var target = event.target;
      if (!target || target == this._container) return;
      while (target.nodeName != 'BUTTON') {
        if (!target.parentNode) break;
        target = target.parentNode;
      }
      if (!target.dataset) return;
      var sku = target.dataset.sku;
      if (!sku) throw new Error('could not find sku, data- attrs not supported?');
      var product = (0, _products.findProduct)(sku, this._products);
      this._cart.add(product);
      this._showConfirmation(product);
    } }, { key: '_showConfirmation', value: function _showConfirmation(

    product) {
      (0, _snackbar2.default)(product.sku + ' added to cart');
    }

    // utility for unit testing (used in counting the number of elements)
  }, { key: 'itemSelector', get: function get() {
      return this._element + '.' + this._elementClass;
    } }]);return ShopView;}(_view2.default);exports.default = ShopView;

},{"products":13,"snackbar":15,"view":17}],15:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });exports.default =


















showToast; /*
           Copyright 2016 Google Inc.
           
           Licensed under the Apache License, Version 2.0 (the "License");
           you may not use this file except in compliance with the License.
           You may obtain a copy of the License at
           
               http://www.apache.org/licenses/LICENSE-2.0
           
           Unless required by applicable law or agreed to in writing, software
           distributed under the License is distributed on an "AS IS" BASIS,
           WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
           See the License for the specific language governing permissions and
           limitations under the License.
           */ //jshint esversion: 6
// Pop up a user notification
function showToast(message) {var notification = document.getElementById('snackbar');if (notification && 'MaterialSnackbar' in notification) {notification.MaterialSnackbar.showSnackbar({ message: message });}}

},{}],16:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });exports.
















replaceLocationHash = replaceLocationHash;exports.




pushLocationHash = pushLocationHash; /*
                                     Copyright 2016 Google Inc.
                                     
                                     Licensed under the Apache License, Version 2.0 (the "License");
                                     you may not use this file except in compliance with the License.
                                     You may obtain a copy of the License at
                                     
                                         http://www.apache.org/licenses/LICENSE-2.0
                                     
                                     Unless required by applicable law or agreed to in writing, software
                                     distributed under the License is distributed on an "AS IS" BASIS,
                                     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                     See the License for the specific language governing permissions and
                                     limitations under the License.
                                     */ //jshint esversion: 6
function replaceLocationHash(hash) {var baseUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window.location;var url = urlWithHash(hash, baseUrl);history.replaceState({}, "", url);}function pushLocationHash(hash) {var baseUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window.location;window.location = urlWithHash(hash, baseUrl);}function urlWithHash(hash, baseUrl) {var url = baseUrl.toString();var index = url.indexOf('#');if (index >= 0) url = url.substring(0, index);return url + '#' + hash;};

},{}],17:[function(require,module,exports){
'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}} /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Copyright 2016 Google Inc.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Licensed under the Apache License, Version 2.0 (the "License");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      you may not use this file except in compliance with the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      You may obtain a copy of the License at
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          http://www.apache.org/licenses/LICENSE-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Unless required by applicable law or agreed to in writing, software
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      distributed under the License is distributed on an "AS IS" BASIS,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      See the License for the specific language governing permissions and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      limitations under the License.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */var

View = function () {
  function View(containerId) {var renderBeforeVisible = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;_classCallCheck(this, View);
    this._containerId = containerId;
    this._container = document.getElementById(this._containerId);
    this._needsRender = renderBeforeVisible;
  }_createClass(View, [{ key: 'render', value: function render()

    {
      // override this
    } }, { key: 'visible', set: function set(

    vis) {
      if (vis && !this.visible && this._needsRender) {
        // becoming visible, update
        this.render();
      }
      if (vis) {
        this._container.removeAttribute('hidden');
      } else {
        this._container.setAttribute('hidden', true);
      }
    }, get: function get()

    {
      return !this._container.hasAttribute('hidden');
    } }]);return View;}();exports.default = View;

},{}],18:[function(require,module,exports){
'use strict';

(function() {
  function toArray(arr) {
    return Array.prototype.slice.call(arr);
  }

  function promisifyRequest(request) {
    return new Promise(function(resolve, reject) {
      request.onsuccess = function() {
        resolve(request.result);
      };

      request.onerror = function() {
        reject(request.error);
      };
    });
  }

  function promisifyRequestCall(obj, method, args) {
    var request;
    var p = new Promise(function(resolve, reject) {
      request = obj[method].apply(obj, args);
      promisifyRequest(request).then(resolve, reject);
    });

    p.request = request;
    return p;
  }
  
  function promisifyCursorRequestCall(obj, method, args) {
    var p = promisifyRequestCall(obj, method, args);
    return p.then(function(value) {
      if (!value) return;
      return new Cursor(value, p.request);
    });
  }

  function proxyProperties(ProxyClass, targetProp, properties) {
    properties.forEach(function(prop) {
      Object.defineProperty(ProxyClass.prototype, prop, {
        get: function() {
          return this[targetProp][prop];
        },
        set: function(val) {
          this[targetProp][prop] = val;
        }
      });
    });
  }

  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {
    properties.forEach(function(prop) {
      if (!(prop in Constructor.prototype)) return;
      ProxyClass.prototype[prop] = function() {
        return promisifyRequestCall(this[targetProp], prop, arguments);
      };
    });
  }

  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {
    properties.forEach(function(prop) {
      if (!(prop in Constructor.prototype)) return;
      ProxyClass.prototype[prop] = function() {
        return this[targetProp][prop].apply(this[targetProp], arguments);
      };
    });
  }

  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {
    properties.forEach(function(prop) {
      if (!(prop in Constructor.prototype)) return;
      ProxyClass.prototype[prop] = function() {
        return promisifyCursorRequestCall(this[targetProp], prop, arguments);
      };
    });
  }

  function Index(index) {
    this._index = index;
  }

  proxyProperties(Index, '_index', [
    'name',
    'keyPath',
    'multiEntry',
    'unique'
  ]);

  proxyRequestMethods(Index, '_index', IDBIndex, [
    'get',
    'getKey',
    'getAll',
    'getAllKeys',
    'count'
  ]);

  proxyCursorRequestMethods(Index, '_index', IDBIndex, [
    'openCursor',
    'openKeyCursor'
  ]);

  function Cursor(cursor, request) {
    this._cursor = cursor;
    this._request = request;
  }

  proxyProperties(Cursor, '_cursor', [
    'direction',
    'key',
    'primaryKey',
    'value'
  ]);

  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [
    'update',
    'delete'
  ]);

  // proxy 'next' methods
  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {
    if (!(methodName in IDBCursor.prototype)) return;
    Cursor.prototype[methodName] = function() {
      var cursor = this;
      var args = arguments;
      return Promise.resolve().then(function() {
        cursor._cursor[methodName].apply(cursor._cursor, args);
        return promisifyRequest(cursor._request).then(function(value) {
          if (!value) return;
          return new Cursor(value, cursor._request);
        });
      });
    };
  });

  function ObjectStore(store) {
    this._store = store;
  }

  ObjectStore.prototype.createIndex = function() {
    return new Index(this._store.createIndex.apply(this._store, arguments));
  };

  ObjectStore.prototype.index = function() {
    return new Index(this._store.index.apply(this._store, arguments));
  };

  proxyProperties(ObjectStore, '_store', [
    'name',
    'keyPath',
    'indexNames',
    'autoIncrement'
  ]);

  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [
    'put',
    'add',
    'delete',
    'clear',
    'get',
    'getAll',
    'getKey',
    'getAllKeys',
    'count'
  ]);

  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [
    'openCursor',
    'openKeyCursor'
  ]);

  proxyMethods(ObjectStore, '_store', IDBObjectStore, [
    'deleteIndex'
  ]);

  function Transaction(idbTransaction) {
    this._tx = idbTransaction;
    this.complete = new Promise(function(resolve, reject) {
      idbTransaction.oncomplete = function() {
        resolve();
      };
      idbTransaction.onerror = function() {
        reject(idbTransaction.error);
      };
      idbTransaction.onabort = function() {
        reject(idbTransaction.error);
      };
    });
  }

  Transaction.prototype.objectStore = function() {
    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));
  };

  proxyProperties(Transaction, '_tx', [
    'objectStoreNames',
    'mode'
  ]);

  proxyMethods(Transaction, '_tx', IDBTransaction, [
    'abort'
  ]);

  function UpgradeDB(db, oldVersion, transaction) {
    this._db = db;
    this.oldVersion = oldVersion;
    this.transaction = new Transaction(transaction);
  }

  UpgradeDB.prototype.createObjectStore = function() {
    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));
  };

  proxyProperties(UpgradeDB, '_db', [
    'name',
    'version',
    'objectStoreNames'
  ]);

  proxyMethods(UpgradeDB, '_db', IDBDatabase, [
    'deleteObjectStore',
    'close'
  ]);

  function DB(db) {
    this._db = db;
  }

  DB.prototype.transaction = function() {
    return new Transaction(this._db.transaction.apply(this._db, arguments));
  };

  proxyProperties(DB, '_db', [
    'name',
    'version',
    'objectStoreNames'
  ]);

  proxyMethods(DB, '_db', IDBDatabase, [
    'close'
  ]);

  // Add cursor iterators
  // TODO: remove this once browsers do the right thing with promises
  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {
    [ObjectStore, Index].forEach(function(Constructor) {
      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {
        var args = toArray(arguments);
        var callback = args[args.length - 1];
        var nativeObject = this._store || this._index;
        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));
        request.onsuccess = function() {
          callback(request.result);
        };
      };
    });
  });

  // polyfill getAll
  [Index, ObjectStore].forEach(function(Constructor) {
    if (Constructor.prototype.getAll) return;
    Constructor.prototype.getAll = function(query, count) {
      var instance = this;
      var items = [];

      return new Promise(function(resolve) {
        instance.iterateCursor(query, function(cursor) {
          if (!cursor) {
            resolve(items);
            return;
          }
          items.push(cursor.value);

          if (count !== undefined && items.length == count) {
            resolve(items);
            return;
          }
          cursor.continue();
        });
      });
    };
  });

  var exp = {
    open: function(name, version, upgradeCallback) {
      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);
      var request = p.request;

      request.onupgradeneeded = function(event) {
        if (upgradeCallback) {
          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));
        }
      };

      return p.then(function(db) {
        return new DB(db);
      });
    },
    delete: function(name) {
      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);
    }
  };

  if (typeof module !== 'undefined') {
    module.exports = exp;
  }
  else {
    self.idb = exp;
  }
}());

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvc2NyaXB0cy9tYWluLmpzIiwiYXBwL3NjcmlwdHMvbW9kdWxlcy9hcHAuanMiLCJhcHAvc2NyaXB0cy9tb2R1bGVzL2NhcnQtdmlldy5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvY2FydC5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvY29uZmlybWF0aW9uLXZpZXcuanMiLCJhcHAvc2NyaXB0cy9tb2R1bGVzL2ZlYXR1cmVzLmpzIiwiYXBwL3NjcmlwdHMvbW9kdWxlcy9oZWFkZXItY29udHJvbGxlci5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvaWRiLXN0b3JhZ2UuanMiLCJhcHAvc2NyaXB0cy9tb2R1bGVzL21lcmNoYW50LXNlcnZlci5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvcGF5bWVudC1hcGkuanMiLCJhcHAvc2NyaXB0cy9tb2R1bGVzL3BheW1lbnQtZm9ybS5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvcHJvZHVjdC5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvcHJvZHVjdHMuanMiLCJhcHAvc2NyaXB0cy9tb2R1bGVzL3Nob3Atdmlldy5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvc25hY2tiYXIuanMiLCJhcHAvc2NyaXB0cy9tb2R1bGVzL3VybC10b29scy5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvdmlldy5qcyIsIm5vZGVfbW9kdWxlcy9pZGIvbGliL2lkYi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3FCQSwwQjtBQUNBLG9DLDhGQXRCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7c0lBa0JBLHdCLENBQ0E7QUFLQSxDQUFDLFlBQVcsQ0FDWixhQURZLENBR1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFJLGNBQWMsUUFBUSxPQUFPLFFBQVAsQ0FBZ0IsUUFBaEIsS0FBNkIsV0FBN0IsSUFDdEI7QUFDQSxT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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKiFcbiAqXG4gKiAgV2ViIFN0YXJ0ZXIgS2l0XG4gKiAgQ29weXJpZ2h0IDIwMTUgR29vZ2xlIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqICB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgaHR0cHM6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqICBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiAgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqICBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZVxuICpcbiAqL1xuLyogZXNsaW50LWVudiBicm93c2VyICovXG4vLyBqc2hpbnQgZXN2ZXJzaW9uOiA2XG5cbmltcG9ydCBBcHAgZnJvbSAnYXBwJztcbmltcG9ydCB7aGFzUHJlcmVxdWlzaXRlc30gZnJvbSAnZmVhdHVyZXMnO1xuXG4oZnVuY3Rpb24oKSB7XG4ndXNlIHN0cmljdCc7XG5cbiAgLy8gQ2hlY2sgdG8gbWFrZSBzdXJlIHNlcnZpY2Ugd29ya2VycyBhcmUgc3VwcG9ydGVkIGluIHRoZSBjdXJyZW50IGJyb3dzZXIsXG4gIC8vIGFuZCB0aGF0IHRoZSBjdXJyZW50IHBhZ2UgaXMgYWNjZXNzZWQgZnJvbSBhIHNlY3VyZSBvcmlnaW4uIFVzaW5nIGFcbiAgLy8gc2VydmljZSB3b3JrZXIgZnJvbSBhbiBpbnNlY3VyZSBvcmlnaW4gd2lsbCB0cmlnZ2VyIEpTIGNvbnNvbGUgZXJyb3JzLiBTZWVcbiAgLy8gaHR0cDovL3d3dy5jaHJvbWl1bS5vcmcvSG9tZS9jaHJvbWl1bS1zZWN1cml0eS9wcmVmZXItc2VjdXJlLW9yaWdpbnMtZm9yLXBvd2VyZnVsLW5ldy1mZWF0dXJlc1xuICB2YXIgaXNMb2NhbGhvc3QgPSBCb29sZWFuKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PT0gJ2xvY2FsaG9zdCcgfHxcbiAgICAgIC8vIFs6OjFdIGlzIHRoZSBJUHY2IGxvY2FsaG9zdCBhZGRyZXNzLlxuICAgICAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnWzo6MV0nIHx8XG4gICAgICAvLyAxMjcuMC4wLjEvOCBpcyBjb25zaWRlcmVkIGxvY2FsaG9zdCBmb3IgSVB2NC5cbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZS5tYXRjaChcbiAgICAgICAgL14xMjcoPzpcXC4oPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pKXszfSQvXG4gICAgICApXG4gICAgKTtcblxuICAvLyBUT0RPIFNXLTIgLSByZWdpc3RlciB0aGUgc2VydmljZSB3b3JrZXJcbiAgaWYgKCdzZXJ2aWNlV29ya2VyJyBpbiBuYXZpZ2F0b3IgJiZcbiAgICAgICh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonIHx8IGlzTG9jYWxob3N0KSkge1xuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCdzZXJ2aWNlLXdvcmtlci5qcycpXG4gICAgLnRoZW4oZnVuY3Rpb24ocmVnaXN0cmF0aW9uKSB7XG4gICAgICAvLyB1cGRhdGVmb3VuZCBpcyBmaXJlZCBpZiBzZXJ2aWNlLXdvcmtlci5qcyBjaGFuZ2VzLlxuICAgICAgcmVnaXN0cmF0aW9uLm9udXBkYXRlZm91bmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gdXBkYXRlZm91bmQgaXMgYWxzbyBmaXJlZCB0aGUgdmVyeSBmaXJzdCB0aW1lIHRoZSBTVyBpcyBpbnN0YWxsZWQsXG4gICAgICAgIC8vIGFuZCB0aGVyZSdzIG5vIG5lZWQgdG8gcHJvbXB0IGZvciBhIHJlbG9hZCBhdCB0aGF0IHBvaW50LlxuICAgICAgICAvLyBTbyBjaGVjayBoZXJlIHRvIHNlZSBpZiB0aGUgcGFnZSBpcyBhbHJlYWR5IGNvbnRyb2xsZWQsXG4gICAgICAgIC8vIGkuZS4gd2hldGhlciB0aGVyZSdzIGFuIGV4aXN0aW5nIHNlcnZpY2Ugd29ya2VyLlxuICAgICAgICBpZiAobmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlcikge1xuICAgICAgICAgIC8vIFRoZSB1cGRhdGVmb3VuZCBldmVudCBpbXBsaWVzIHRoYXQgcmVnaXN0cmF0aW9uLmluc3RhbGxpbmcgaXMgc2V0OlxuICAgICAgICAgIC8vIGh0dHBzOi8vc2xpZ2h0bHlvZmYuZ2l0aHViLmlvL1NlcnZpY2VXb3JrZXIvc3BlYy9zZXJ2aWNlX3dvcmtlci9pbmRleC5odG1sI3NlcnZpY2Utd29ya2VyLWNvbnRhaW5lci11cGRhdGVmb3VuZC1ldmVudFxuICAgICAgICAgIHZhciBpbnN0YWxsaW5nV29ya2VyID0gcmVnaXN0cmF0aW9uLmluc3RhbGxpbmc7XG5cbiAgICAgICAgICBpbnN0YWxsaW5nV29ya2VyLm9uc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoaW5zdGFsbGluZ1dvcmtlci5zdGF0ZSkge1xuICAgICAgICAgICAgICBjYXNlICdpbnN0YWxsZWQnOlxuICAgICAgICAgICAgICAgIC8vIEF0IHRoaXMgcG9pbnQsIHRoZSBvbGQgY29udGVudCB3aWxsIGhhdmUgYmVlbiBwdXJnZWQgYW5kIHRoZVxuICAgICAgICAgICAgICAgIC8vIGZyZXNoIGNvbnRlbnQgd2lsbCBoYXZlIGJlZW4gYWRkZWQgdG8gdGhlIGNhY2hlLlxuICAgICAgICAgICAgICAgIC8vIEl0J3MgdGhlIHBlcmZlY3QgdGltZSB0byBkaXNwbGF5IGEgXCJOZXcgY29udGVudCBpc1xuICAgICAgICAgICAgICAgIC8vIGF2YWlsYWJsZTsgcGxlYXNlIHJlZnJlc2guXCIgbWVzc2FnZSBpbiB0aGUgcGFnZSdzIGludGVyZmFjZS5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlICdyZWR1bmRhbnQnOlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGluc3RhbGxpbmcgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzZXJ2aWNlIHdvcmtlciBiZWNhbWUgcmVkdW5kYW50LicpO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy8gSWdub3JlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KS5jYXRjaChmdW5jdGlvbihlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgc2VydmljZSB3b3JrZXIgcmVnaXN0cmF0aW9uOicsIGUpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gWW91ciBjdXN0b20gSmF2YVNjcmlwdCBnb2VzIGhlcmVcbiAgbGV0IGFwcCA9IG5ldyBBcHAoKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGUgPT4ge1xuICAgIGlmICghaGFzUHJlcmVxdWlzaXRlcygpKSB7XG4gICAgICAvLyBUT0RPIG1ha2UgdGhpcyBzb21ldGhpbmcgbmljZXIgdGhhbiBhbiBhbGVydCwgZS5nLiBhIHBhbmVsIGluIHRoZSBhcHBcbiAgICAgIHdpbmRvdy5hbGVydCgnVGhpcyBicm93c2VyIGlzIG1pc3Npbmcgc29tZSByZXF1aXJlZCBmZWF0dXJlcycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhcHAuaW5zdGFsbCgpO1xuICAgIGFwcC5ydW4oKTtcbiAgfSk7XG5cbn0pKCk7XG4iLCIvKlxuQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgQ2FydCBmcm9tICdjYXJ0JztcbmltcG9ydCBJREJTdG9yYWdlIGZyb20gJ2lkYi1zdG9yYWdlJztcbmltcG9ydCBMb2NhbFN0b3JhZ2UgZnJvbSAnaWRiLXN0b3JhZ2UnO1xuaW1wb3J0IENhcnRWaWV3IGZyb20gJ2NhcnQtdmlldyc7XG5pbXBvcnQgU2hvcFZpZXcgZnJvbSAnc2hvcC12aWV3JztcbmltcG9ydCBQYXltZW50Rm9ybSBmcm9tICdwYXltZW50LWZvcm0nO1xuaW1wb3J0IFBheW1lbnRBUElXcmFwcGVyIGZyb20gJ3BheW1lbnQtYXBpJztcbmltcG9ydCBDb25maXJtYXRpb25WaWV3IGZyb20gJ2NvbmZpcm1hdGlvbi12aWV3JztcbmltcG9ydCBIZWFkZXJDb250cm9sbGVyIGZyb20gJ2hlYWRlci1jb250cm9sbGVyJztcbmltcG9ydCB7cmVwbGFjZUxvY2F0aW9uSGFzaH0gZnJvbSAndXJsLXRvb2xzJztcbmltcG9ydCAqIGFzIGZlYXR1cmVzIGZyb20gJ2ZlYXR1cmVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwIHtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9zdG9yYWdlID0gZmVhdHVyZXMuaGFzSW5kZXhlZERCID8gbmV3IElEQlN0b3JhZ2UoKSA6IG5ldyBMb2NhbFN0b3JhZ2UoKTtcbiAgICB0aGlzLl9jYXJ0ID0gbmV3IENhcnQodGhpcy5fc3RvcmFnZSwgdGhpcy5fY2FydENoYW5nZWQuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5fY2FydFZpZXcgPSBuZXcgQ2FydFZpZXcodGhpcy5fY2FydCk7XG4gICAgdGhpcy5fc2hvcFZpZXcgPSBuZXcgU2hvcFZpZXcodGhpcy5fY2FydCk7XG4gICAgdGhpcy5fcGF5bWVudEZvcm0gPSBuZXcgUGF5bWVudEZvcm0odGhpcy5fY2FydCk7XG4gICAgdGhpcy5fY29uZmlybWF0aW9uVmlldyA9IG5ldyBDb25maXJtYXRpb25WaWV3KCk7XG4gICAgdGhpcy5faGVhZGVyID0gbmV3IEhlYWRlckNvbnRyb2xsZXIoKTtcbiAgICB0aGlzLl9oYXNoQ2hhbmdlTGlzdGVuZXIgPSB0aGlzLl9oYW5kbGVIYXNoQ2hhbmdlLmJpbmQodGhpcyk7XG4gIH1cblxuICBpbnN0YWxsKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5faGFzaENoYW5nZUxpc3RlbmVyKTtcbiAgICB0aGlzLl9zaG9wVmlldy5pbnN0YWxsKCk7XG4gICAgdGhpcy5fY2FydFZpZXcuaW5zdGFsbCgpO1xuICB9XG5cbiAgdW5pbnN0YWxsKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5faGFzaENoYW5nZUxpc3RlbmVyKTtcbiAgfVxuXG4gIC8vIE1hbmFnZSBlbGVtZW50IHZpc2liaWxpdHkgKGhpZGUgdGhlIGNhcnQgd2hlbiBzdG9yZSBpcyBzZWxlY3RlZCBhbmQgdmljZSB2ZXJzYSlcbiAgc2V0IHNlbGVjdGlvbihzZWwpIHtcbiAgICBzd2l0Y2goc2VsKSB7XG4gICAgICBjYXNlICdzaG9wJzpcbiAgICAgIGNhc2UgJ2NhcnQnOlxuICAgICAgICB0aGlzLl9oZWFkZXIuc2VsZWN0aW9uID0gc2VsO1xuICAgICAgICB0aGlzLl9zaG9wVmlldy52aXNpYmxlID0gc2VsID09PSAnc2hvcCc7XG4gICAgICAgIHRoaXMuX2NhcnRWaWV3LnZpc2libGUgPSBzZWwgIT09ICdzaG9wJztcbiAgICAgICAgdGhpcy5fcGF5bWVudEZvcm0udmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jb25maXJtYXRpb25WaWV3LnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3BheSc6XG4gICAgICAgIHRoaXMuX2hlYWRlci5zZWxlY3Rpb24gPSAnY2FydCc7XG4gICAgICAgIHRoaXMuX2NhcnRWaWV3LnZpc2libGUgPSB0cnVlO1xuICAgICAgICB0aGlzLl9jb25maXJtYXRpb25WaWV3LnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcGF5bWVudEZvcm0udmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICBsZXQgX3Byb21pc2U7XG5cbiAgICAgICAgLy8gVE9ETyBQQVktMi4xIC0gZGV0ZWN0IGZlYXR1cmVcblxuICAgICAgICBpZiAod2luZG93LlBheW1lbnRSZXF1ZXN0KSB7XG4gICAgICAgICAgbGV0IGFwaSA9IG5ldyBQYXltZW50QVBJV3JhcHBlcigpO1xuICAgICAgICAgIF9wcm9taXNlID0gYXBpLmNoZWNrb3V0KHRoaXMuX2NhcnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX3BheW1lbnRGb3JtLnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgIF9wcm9taXNlID0gdGhpcy5fcGF5bWVudEZvcm0uY2hlY2tvdXQodGhpcy5fY2FydCk7XG4gICAgICAgIH1cbiAgICAgICAgX3Byb21pc2VcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9jYXJ0LnJlc2V0KCk7XG4gICAgICAgICAgICByZXBsYWNlTG9jYXRpb25IYXNoKCdzaG9wJyk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbiA9ICdzaG9wJztcbiAgICAgICAgICAgIGFsZXJ0KCdUaGFua3MgZm9yIHNob3BwaW5nISBQYXltZW50IHN1Y2Nlc3NmdWxseSBjb21wbGV0ZSA6KScpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgIGFsZXJ0KCdTb3JyeSwgcGF5bWVudCBmYWlsZWQgOignKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2NvbmZpcm0nOlxuICAgICAgICB0aGlzLl9oZWFkZXIuc2VsZWN0aW9uID0gJ2NhcnQnO1xuICAgICAgICB0aGlzLl9jYXJ0Vmlldy52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3BheW1lbnRGb3JtLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY29uZmlybWF0aW9uVmlldy52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcnVuKCkge1xuICAgIHJlcGxhY2VMb2NhdGlvbkhhc2goJ3Nob3AnKTtcbiAgICB0aGlzLl9jYXJ0LmxvYWQoKS50aGVuKCgpID0+IHtcbiAgICAgIHRoaXMuX3Nob3BWaWV3LnJlbmRlcigpO1xuICAgICAgdGhpcy5fY2FydFZpZXcucmVuZGVyKCk7XG4gICAgICB0aGlzLl91cGRhdGVDYXJ0Q291bnREaXNwbGF5KCk7XG4gICAgICB0aGlzLnNlbGVjdGlvbiA9ICdzaG9wJztcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEhhbmRsZSBoYXNoQ2hhbmdlLCBtYW5hZ2UgaGlzdG9yeSAoI3N0b3JlIG9yICNjYXJ0LCBtYXliZSAjcGF5KVxuICBfaGFuZGxlSGFzaENoYW5nZShldmVudCkge1xuICAgIGlmICghZXZlbnQubmV3VVJMKSByZXR1cm47XG4gICAgbGV0IGluZGV4ID0gZXZlbnQubmV3VVJMLmxhc3RJbmRleE9mKCcjJyk7XG4gICAgaWYgKGluZGV4IDwgMCkgcmV0dXJuO1xuICAgIGxldCBzZWwgPSBldmVudC5uZXdVUkwuc3Vic3RyKGluZGV4KzEpO1xuICAgIHRoaXMuc2VsZWN0aW9uID0gc2VsO1xuICB9XG5cbiAgX2NhcnRDaGFuZ2VkKGRldGFpbHMpIHtcbiAgICBpZiAoZGV0YWlscy5hY3Rpb24gPT09ICdsb2FkJykgcmV0dXJuO1xuICAgIHRoaXMuX3VwZGF0ZUNhcnRDb3VudERpc3BsYXkoKTtcbiAgICB0aGlzLl9jYXJ0Vmlldy5yZW5kZXIoKTtcbiAgICB0aGlzLl9jYXJ0LnNhdmUoKTtcbiAgfVxuXG4gIF91cGRhdGVDYXJ0Q291bnREaXNwbGF5KCkge1xuICAgIHRoaXMuX2hlYWRlci5jb3VudCA9IHRoaXMuX2NhcnQuY291bnQ7XG4gIH1cbiAgLy8gVGVzdGluZyBob29rc1xuICBzZXQgaGVhZGVyQ29udHJvbGxlcihvYmopIHtcbiAgICB0aGlzLl9oZWFkZXIgPSBvYmo7XG4gIH1cblxuICBnZXQgY2FydCgpIHtcbiAgICByZXR1cm4gdGhpcy5fY2FydDtcbiAgfVxuXG4gIGdldCBzdG9yYWdlKCkge1xuICAgIHJldHVybiB0aGlzLl9zdG9yYWdlO1xuICB9XG5cbiAgc2V0IHN0b3JhZ2UoYWRhcHRvcikge1xuICAgIHRoaXMuX3N0b3JhZ2UgPSBhZGFwdG9yO1xuICAgIHRoaXMuX2NhcnQuc3RvcmFnZSA9IGFkYXB0b3I7XG4gIH1cblxufVxuIiwiLypcbkNvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFZpZXcgZnJvbSAndmlldyc7XG5pbXBvcnQge3B1c2hMb2NhdGlvbkhhc2h9IGZyb20gJ3VybC10b29scyc7XG5pbXBvcnQge2ZpbmRQcm9kdWN0fSBmcm9tICdwcm9kdWN0cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcnRWaWV3IGV4dGVuZHMgVmlldyB7XG5cbiAgY29uc3RydWN0b3IoY2FydCwgY29udGFpbmVySWQgPSAnY2FydCcpIHtcbiAgICBzdXBlcihjb250YWluZXJJZCk7XG4gICAgdGhpcy5fY2FydCA9IGNhcnQ7XG4gICAgdGhpcy5fZWxlbWVudCA9ICd0cic7XG4gICAgdGhpcy5fZWxlbWVudENsYXNzID0gJ3Byb2R1Y3QnO1xuICAgIHRoaXMuX2NsaWNrSGFuZGxlciA9IG51bGw7XG4gICAgdGhpcy5fdGJvZHkgPSB0aGlzLl9jb250YWluZXIucXVlcnlTZWxlY3RvcigndGJvZHknKTtcbiAgICB0aGlzLl9jaGVja291dEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGVja291dEJ0bicpO1xuICB9XG5cbiAgaW5zdGFsbCgpIHtcbiAgICB0aGlzLl9jbGlja0hhbmRsZXIgPSB0aGlzLl9oYW5kbGVDbGljay5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2NsaWNrSGFuZGxlciwgdHJ1ZSk7XG4gICAgLy8gQ2hlY2tvdXQgYnV0dG9uIHN3aXRjaGVzIGhhc2ggdG8gXCJwYXlcIiwgd2lsbCBjYXVzZSB0aGUgZm9ybSB0byBvcGVuXG4gICAgdGhpcy5fY2hlY2tvdXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9nb1RvUGF5bWVudC5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICAvLyBSZW1vdmUgZXhpc3RpbmcgcHJvZHVjdHNcbiAgICBsZXQgaXRlbVJvd3MgPSB0aGlzLl90Ym9keS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuaXRlbVNlbGVjdG9yKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1Sb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLl90Ym9keS5yZW1vdmVDaGlsZChpdGVtUm93c1tpXSk7XG4gICAgfVxuICAgIGZvciAobGV0IGl0ZW0gb2YgdGhpcy5fY2FydC5jYXJ0KSB7XG4gICAgICBsZXQgcHJvZHVjdCA9IGZpbmRQcm9kdWN0KGl0ZW0uc2t1KTtcbiAgICAgIGxldCBwbGFjZWhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3Rib2R5Jyk7XG4gICAgICBwbGFjZWhvbGRlci5pbm5lckhUTUwgPSBgPHRyIGNsYXNzPVwicHJvZHVjdFwiIGRhdGEtc2t1PVwiJHtwcm9kdWN0LnNrdX1cIj5cbiAgICAgICAgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtbm9uLW51bWVyaWNcIj4ke3Byb2R1Y3QudGl0bGV9PC90ZD5cbiAgICAgICAgPHRkPiR7aXRlbS5xdWFudGl0eX08L3RkPlxuICAgICAgICA8dGQ+UnAuICR7cHJvZHVjdC5wcmljZX08L3RkPlxuICAgICAgICA8dGQ+PGJ1dHRvbiBjbGFzcz1cIm1kbC1idXR0b24gbWRsLWJ1dHRvbi0tY29sb3JlZCBtZGwtanMtYnV0dG9uXG4gICAgICAgICAgICAgIG1kbC1qcy1yaXBwbGUtZWZmZWN0IG1kbC1idXR0b24tLWFjY2VudCBkZWxldGVcIlxuICAgICAgICAgICAgICBkYXRhLXNrdT1cIiR7cHJvZHVjdC5za3V9XCIgZGF0YS1hY3Rpb249XCJyZW1vdmVcIj5cbiAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmRlbGV0ZTwvaT5yZW1vdmU8L2J1dHRvbj5cbiAgICAgICAgPC90ZD5cbiAgICAgIDwvdHI+YDtcbiAgICAgIHRoaXMuX3Rib2R5LmFwcGVuZENoaWxkKHBsYWNlaG9sZGVyLmZpcnN0RWxlbWVudENoaWxkKTsgLy8gV0FSTjogbm8gaWU4XG4gICAgfVxuICAgIC8vIEFkZCB0aGUgdG90YWwgcHJpY2VcbiAgICB0aGlzLnVwZGF0ZVRvdGFsKCk7XG4gIH1cblxuICB1cGRhdGVUb3RhbCgpIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FydC10b3RhbCcpLmlubmVyVGV4dCA9IGBScC4gJHt0aGlzLl9jYXJ0LnRvdGFsfWA7XG4gIH1cblxuICByZW1vdmVGcm9tVmlldyhza3UpIHtcbiAgICBsZXQgcm93ID0gdGhpcy5fdGJvZHkucXVlcnlTZWxlY3RvcihgdHJbZGF0YS1za3U9JHtza3V9XWApO1xuICAgIGlmIChyb3cpIHtcbiAgICAgIHJvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvdyk7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlVG90YWwoKTtcbiAgfVxuXG4gIF9nb1RvUGF5bWVudCgpIHtcbiAgICBwdXNoTG9jYXRpb25IYXNoKCdwYXknKTtcbiAgfVxuXG4gIF9oYW5kbGVDbGljayhldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQuZGF0YXNldCkge1xuICAgICAgdmFyIHNrdSA9IGV2ZW50LnRhcmdldC5kYXRhc2V0LnNrdTtcbiAgICAgIHZhciBhY3Rpb24gPSBldmVudC50YXJnZXQuZGF0YXNldC5hY3Rpb247XG4gICAgICBpZiAoc2t1ICYmIGFjdGlvbiA9PSAncmVtb3ZlJykge1xuICAgICAgICB2YXIgcHJvZHVjdCA9IHRoaXMuX2NhcnQuZmluZEl0ZW0oc2t1KTtcbiAgICAgICAgdGhpcy5fY2FydC5yZW1vdmUocHJvZHVjdCk7XG4gICAgICAgIHRoaXMucmVtb3ZlRnJvbVZpZXcoc2t1KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyB1dGlsaXR5IGZvciB1bml0IHRlc3RpbmcgKHVzZWQgaW4gY291bnRpbmcgdGhlIG51bWJlciBvZiBlbGVtZW50cylcbiAgZ2V0IGl0ZW1TZWxlY3RvcigpIHtcbiAgICByZXR1cm4gYCR7dGhpcy5fZWxlbWVudH0uJHt0aGlzLl9lbGVtZW50Q2xhc3N9W2RhdGEtc2t1XWA7XG4gIH1cblxuICBzZXQgY2FydChjYXJ0KSB7XG4gICAgdGhpcy5fY2FydCA9IGNhcnQ7XG4gIH1cblxufVxuIiwiLypcbkNvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuLy9qc2hpbnQgZXN2ZXJzaW9uOiA2XG5cbmltcG9ydCB7IGZpbmRQcm9kdWN0IH0gZnJvbSAncHJvZHVjdHMnO1xuXG5leHBvcnQgY29uc3QgQ0FSVF9FVkVOVCA9IFwiY2FydGNoYW5nZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJ0IHtcbiAgY29uc3RydWN0b3IgKGFkYXB0b3IsIGNoYW5nZUNhbGxiYWNrKSB7XG4gICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgIHRoaXMuX3N0b3JhZ2UgPSBhZGFwdG9yO1xuICAgIHRoaXMuX2xvYWRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLl9jYWxsYmFjayA9IGNoYW5nZUNhbGxiYWNrOyAvLyB1c2VkIHRvIHJlcG9ydCBjaGFuZ2VzIGJhY2sgdG8gdGhlIGFwcFxuICB9XG5cbiAgZmluZEl0ZW0oc2t1KSB7XG4gICAgcmV0dXJuIHRoaXMuaXRlbXMuZmluZChpdGVtID0+IGl0ZW0uc2t1ID09PSBza3UpO1xuICB9XG5cbiAgYWRkKHByb2R1Y3QsIHF1YW50aXR5PTEpIHtcbiAgICBpZiAocXVhbnRpdHkgPCAwIHx8ICFwcm9kdWN0KSByZXR1cm4gbnVsbDtcbiAgICBsZXQgaXRlbSA9IHRoaXMuZmluZEl0ZW0ocHJvZHVjdC5za3UpO1xuICAgIGlmIChpdGVtKSB7XG4gICAgICBpdGVtLnF1YW50aXR5ICs9IHF1YW50aXR5O1xuICAgIH0gZWxzZSB7XG4gICAgICBpdGVtID0gbmV3IExpbmVJdGVtKHByb2R1Y3QsIHF1YW50aXR5KTtcbiAgICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcbiAgICB9XG4gICAgdGhpcy5fcmVwb3J0Q2hhbmdlKCdhZGQnLCBwcm9kdWN0LCBxdWFudGl0eSk7XG4gICAgcmV0dXJuIGl0ZW07XG4gIH1cblxuICByZW1vdmUocHJvZHVjdCkge1xuICAgIGxldCBpbmRleCA9IHRoaXMuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5za3UgPT09IHByb2R1Y3Quc2t1KTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgdGhpcy5pdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgICB0aGlzLl9yZXBvcnRDaGFuZ2UoJ3JlbW92ZScsIHByb2R1Y3QpO1xuICB9XG5cbiAgY2hhbmdlKHByb2R1Y3QsIHF1YW50aXR5KSB7XG4gICAgbGV0IGl0ZW0gPSB0aGlzLmZpbmRJdGVtKHByb2R1Y3Quc2t1KTtcbiAgICBpZiAocXVhbnRpdHkgPD0gMCkge1xuICAgICAgdGhpcy5yZW1vdmUoaXRlbSk7XG4gICAgICB0aGlzLl9yZXBvcnRDaGFuZ2UoJ3JlbW92ZScsIHByb2R1Y3QpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIGl0ZW0ucXVhbnRpdHkgPSBxdWFudGl0eTtcbiAgICAgIHRoaXMuX3JlcG9ydENoYW5nZSgnY2hhbmdlJywgcHJvZHVjdCwgcXVhbnRpdHkpO1xuICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfVxuICB9XG5cbiAgcmVzZXQoKSB7XG4gICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgIHRoaXMuX3JlcG9ydENoYW5nZSgncmVzZXQnKTtcbiAgfVxuXG4gIGdldCBsZW5ndGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXRlbXMubGVuZ3RoO1xuICB9XG5cbiAgZ2V0IGNvdW50KCkge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgZm9yIChsZXQgaXRlbSBvZiB0aGlzLml0ZW1zKSB7XG4gICAgICBjb3VudCArPSBpdGVtLnF1YW50aXR5O1xuICAgIH1cbiAgICByZXR1cm4gY291bnQ7XG4gIH1cblxuICBnZXQgdG90YWwoKSB7XG4gICAgbGV0IHRvdGFsID0gMDtcbiAgICBmb3IgKGxldCBpdGVtIG9mIHRoaXMuaXRlbXMpIHtcbiAgICAgIHRvdGFsICs9IGl0ZW0udG90YWw7XG4gICAgfVxuICAgIHJldHVybiB0b3RhbDtcbiAgfVxuXG4gIGdldCBjYXJ0KCkge1xuICAgIHJldHVybiB0aGlzLml0ZW1zO1xuICB9XG5cbiAgc2F2ZSgpIHtcbiAgICBpZiAoIXRoaXMuX3N0b3JhZ2UpIHJldHVybjtcbiAgICByZXR1cm4gdGhpcy5fc3RvcmFnZS5zYXZlKHRoaXMuaXRlbXMubWFwKChpdGVtKSA9PiBpdGVtLnNhdmVkVmFsdWUpKTtcbiAgfVxuXG4gIGxvYWQoKSB7XG4gICAgaWYgKCF0aGlzLl9zdG9yYWdlKSByZXR1cm47XG4gICAgdGhpcy5fbG9hZGluZyA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXMuX3N0b3JhZ2UubG9hZCgpLnRoZW4obG9hZGVkSXRlbXMgPT4ge1xuICAgICAgdGhpcy5pdGVtcyA9IGxvYWRlZEl0ZW1zLm1hcCgocykgPT4geyBsZXQgbGkgPSBuZXcgTGluZUl0ZW0oKTsgbGkuc2F2ZWRWYWx1ZSA9IHM7IHJldHVybiBsaX0pO1xuICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5fbG9hZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5fcmVwb3J0Q2hhbmdlKCdsb2FkJyk7XG4gICAgICByZXR1cm4gdGhpcy5pdGVtcztcbiAgICB9KTtcbiAgfVxuXG4gIF9yZXBvcnRDaGFuZ2UoYWN0aW9uLCBwcm9kdWN0LCBxdWFudGl0eSkge1xuICAgIGlmICh0aGlzLl9sb2FkaW5nKSByZXR1cm47IC8vIGRvbid0IHNwYW0gdGhlIGFwcCB3aXRoIGV2ZW50c1xuICAgIGxldCBkZXRhaWxzID0geydhY3Rpb24nOiAoYWN0aW9uKSwgJ3RvdGFsJzogKHRoaXMudG90YWwpfTtcbiAgICBpZiAocHJvZHVjdCkgZGV0YWlscy5za3UgPSBwcm9kdWN0LnNrdTtcbiAgICBpZiAocXVhbnRpdHkpIGRldGFpbHMucXVhbnRpdHkgPSBxdWFudGl0eTtcbiAgICBpZiAodGhpcy5fY2FsbGJhY2spIHRoaXMuX2NhbGxiYWNrKGRldGFpbHMpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBMaW5lSXRlbSB7XG4gIGNvbnN0cnVjdG9yKHByb2R1Y3QsIHF1YW50aXR5KSB7XG4gICAgaWYgKHByb2R1Y3QgPT0gbnVsbCkge1xuICAgICAgdGhpcy5fc2t1ID0gbnVsbDtcbiAgICAgIHRoaXMuX3ByaWNlID0gdGhpcy5fcXVhbnRpdHkgPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9za3UgPSBwcm9kdWN0LnNrdTtcbiAgICAgIHRoaXMuX3ByaWNlID0gcHJvZHVjdC5wcmljZTtcbiAgICAgIHRoaXMuX3F1YW50aXR5ID0gcXVhbnRpdHk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNrdSgpIHtcbiAgICByZXR1cm4gdGhpcy5fc2t1O1xuICB9XG5cbiAgZ2V0IHByaWNlKCkge1xuICAgIHJldHVybiB0aGlzLl9wcmljZTtcbiAgfVxuXG4gIGdldCB0b3RhbCgpIHtcbiAgICByZXR1cm4gdGhpcy5fcXVhbnRpdHkgKiB0aGlzLl9wcmljZTtcbiAgfVxuXG4gIGdldCBxdWFudGl0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcXVhbnRpdHk7XG4gIH1cblxuICBzZXQgcXVhbnRpdHkodmFsdWUpIHtcbiAgICB0aGlzLl9xdWFudGl0eSA9IHZhbHVlIDwgMCA/IDAgOiB2YWx1ZTtcbiAgfVxuXG4gIC8vIE9ubHkgc2F2ZSBtaW5pbWFsIGluZm9ybWF0aW9uICh0byBjb25zZXJ2ZSBzcGFjZSAmIHByZXZlbnQgc3Bvb2ZpbmcpXG4gIGdldCBzYXZlZFZhbHVlKCkge1xuICAgIHJldHVybiB7c2t1OiAodGhpcy5fc2t1KSwgcXR5OiAodGhpcy5fcXVhbnRpdHkpfTtcbiAgfVxuXG4gIHNldCBzYXZlZFZhbHVlKHZhbHVlKSB7XG4gICAgbGV0IHByb2R1Y3QgPSBmaW5kUHJvZHVjdCh2YWx1ZS5za3UpO1xuICAgIGlmICghcHJvZHVjdCkgdGhyb3cgbmV3IEVycm9yKGBTS1Ugbm90IGZvdW5kOiAke3ZhbHVlLnNrdX1gKTtcbiAgICB0aGlzLl9za3UgPSB2YWx1ZS5za3U7XG4gICAgdGhpcy5fcXVhbnRpdHkgPSB2YWx1ZS5xdHk7XG4gICAgdGhpcy5fcHJpY2UgPSBwcm9kdWN0LnByaWNlO1xuICB9XG5cbiAgc2V0IHN0b3JhZ2UoYWRhcHRvcikge1xuICAgIHRoaXMuX3N0b3JhZ2UgPSBhZGFwdG9yO1xuICB9XG5cbn1cbiIsIi8qXG5Db3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBWaWV3IGZyb20gJ3ZpZXcnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb25maXJtYXRpb25WaWV3IGV4dGVuZHMgVmlldyB7XG5cbiAgY29uc3RydWN0b3IoY29udGFpbmVySWQgPSAnY29uZmlybWF0aW9uJykge1xuICAgIHN1cGVyKGNvbnRhaW5lcklkKTtcbiAgICB0aGlzLl9yZXF1ZXN0RGF0YSA9ICcnO1xuICAgIHRoaXMuX3Jlc3BvbnNlRGF0YSA9ICcnO1xuICAgIHRoaXMuX3JlcXVlc3REaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVxdWVzdERhdGEnKTtcbiAgICB0aGlzLl9yZXNwb25zZURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNwb25zZURhdGEnKTtcbiAgICAvLyB0aGlzLl9jbGlja0hhbmRsZXIgPSBudWxsO1xuICAgIC8vIHRoaXMuX2NoZWNrb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoZWNrb3V0QnRuJyk7XG4gIH1cblxuICBpbnN0YWxsKCkge1xuICAgIC8vIHRoaXMuX2NsaWNrSGFuZGxlciA9IHRoaXMuX2hhbmRsZUNsaWNrLmJpbmQodGhpcyk7XG4gICAgLy8gdGhpcy5fY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fY2xpY2tIYW5kbGVyLCB0cnVlKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICB0aGlzLl9yZXF1ZXN0RGl2LmlubmVyVGV4dCA9IHRoaXMuX3JlcXVlc3REYXRhO1xuICAgIHRoaXMuX3Jlc3BvbnNlRGl2LmlubmVyVGV4dCA9IHRoaXMuX3Jlc3BvbnNlRGF0YTtcbiAgfVxuXG4gIHNldCByZXF1ZXN0RGF0YSh2YWx1ZSkge1xuICAgIHRoaXMuX3JlcXVlc3REYXRhID0gKHZhbHVlID09PSBudWxsID8gJycgOiB2YWx1ZSk7XG4gICAgdGhpcy5fcmVuZGVyKCk7XG4gIH1cblxuICBzZXQgcmVzcG9uc2VEYXRhKHZhbHVlKSB7XG4gICAgdGhpcy5fcmVzcG9uc2VEYXRhID0gKHZhbHVlID09PSBudWxsID8gJycgOiB2YWx1ZSk7XG4gICAgdGhpcy5fcmVuZGVyKCk7XG4gIH1cblxufVxuIiwiLypcbkNvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1ByZXJlcXVpc2l0ZXMoKSB7XG4gIGNvbnN0IGhhc1N0b3JhZ2UgPSBoYXNMb2NhbFN0b3JhZ2UoKSB8fCBoYXNJbmRleGVkREIoKTtcbiAgLy8gZmlyc3RFbGVtZW50Q2hpbGQgbm90IGluIGllOFxuICBjb25zdCBoYXNGaXJzdEVsZW1lbnRDaGlsZCA9ICgnZmlyc3RFbGVtZW50Q2hpbGQnIGluIGRvY3VtZW50KTtcbiAgcmV0dXJuIGhhc1N0b3JhZ2UgJiBoYXNGaXJzdEVsZW1lbnRDaGlsZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0xvY2FsU3RvcmFnZSgpIHtcbiAgcmV0dXJuICgnTG9jYWxTdG9yYWdlJyBpbiB3aW5kb3cpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzSW5kZXhlZERCKCkge1xuICByZXR1cm4gKCdpbmRleGVkREInIGluIHdpbmRvdyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNQYXltZW50UmVxdWVzdCgpIHtcbiAgcmV0dXJuICgnUGF5bWVudFJlcXVlc3QnIGluIHdpbmRvdyk7XG59XG4iLCIvKlxuQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG4vL2pzaGludCBlc3ZlcnNpb246IDZcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhlYWRlckNvbnRyb2xsZXIge1xuXG4gIGNvbnN0cnVjdG9yIChjb250YWluZXJJZD0naGVhZGVycycpIHtcbiAgICB0aGlzLl9jb250YWluZXJJZCA9IGNvbnRhaW5lcklkO1xuICAgIHRoaXMuX3NlbGVjdGlvbiA9ICdzaG9wJztcbiAgICB0aGlzLl9jb3VudCA9IDA7XG4gIH1cblxuICBnZXQgc2VsZWN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uO1xuICB9XG5cbiAgc2V0IHNlbGVjdGlvbihuZXdWYWx1ZSkge1xuICAgIGlmIChuZXdWYWx1ZSAhPSAnc2hvcCcgJiYgbmV3VmFsdWUgIT0gJ2NhcnQnKSByZXR1cm47XG4gICAgaWYgKG5ld1ZhbHVlID09IHRoaXMuX3NlbGVjdGlvbikgcmV0dXJuO1xuICAgIHRoaXMuX3NlbGVjdGlvbiA9IG5ld1ZhbHVlO1xuXG4gICAgLy8gTm93IHVwZGF0ZSB0aGUgVUlcbiAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5fY29udGFpbmVySWQpO1xuICAgIC8vIE9ubHkgdHdvIGtpbmRzIG9mIGxpbmtzLCBzbyBmbGlwIGFjdGl2ZVxuICAgIGxldCBsaW5rcyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdhLm1kbC1uYXZpZ2F0aW9uX19saW5rJyk7XG4gICAgZm9yIChsZXQgaT0wOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxpbmtzW2ldLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBjb3VudCgpIHtcbiAgICByZXR1cm4gdGhpcy5fY291bnQ7XG4gIH1cblxuICBzZXQgY291bnQobmV3Q291bnQpIHtcbiAgICBpZiAodGhpcy5fY291bnQgPT0gbmV3Q291bnQpIHJldHVybjtcbiAgICAvLyBUT0RPIHVzZSBhIGJhZGdlIGluc3RlYWRcbiAgICB2YXIgbGFiZWwgPSBuZXdDb3VudCA9PT0gMCA/ICcnIDogYCAoJHtuZXdDb3VudH0gaXRlbXMpYDtcbiAgICB0aGlzLl9jb3VudCA9IG5ld0NvdW50O1xuICAgIGxldCBzcGFucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCMke3RoaXMuX2NvbnRhaW5lcklkfSBhW2hyZWY9XCIjY2FydFwiXWApO1xuICAgIGZvciAobGV0IGk9MDsgaSA8IHNwYW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzcGFuc1tpXS5pbm5lclRleHQgPSBgQ2FydCR7bGFiZWx9YDtcbiAgICB9XG4gIH1cblxufVxuIiwiLypcbkNvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0ICogYXMgaWRiIGZyb20gJ2lkYic7XG5cbmNvbnN0IENBUlRfU1RPUkUgPSAnY2FydCc7XG5jb25zdCBSVyA9ICdyZWFkd3JpdGUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJREJTdG9yYWdlIHtcblxuICBjb25zdHJ1Y3RvcihpZCA9ICdtZnMtY2FydC1pdGVtcycpIHtcbiAgICB0aGlzLl9pZCA9IGlkO1xuICAgIHRoaXMuX29wZW4oKTtcbiAgfVxuXG4gIC8qIFRha2VzIGFuIGFycmF5IG9mIGl0ZW1zIGFuZCB3cml0ZXMgSlNPTiB0byBsb2NhbCBzdG9yYWdlICovXG4gIHNhdmUoaXRlbXMpIHtcbiAgICByZXR1cm4gdGhpcy5fZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xuICAgICAgY29uc3QgdHggPSBkYi50cmFuc2FjdGlvbihDQVJUX1NUT1JFLCBSVyk7XG4gICAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKENBUlRfU1RPUkUpO1xuICAgICAgcmV0dXJuIHN0b3JlLmNsZWFyKCkudGhlbigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFkZEFsbCA9IGl0ZW1zLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgIHJldHVybiBzdG9yZS5hZGQoe3NrdTogKGl0ZW0uc2t1KSwgcXR5OiAoaXRlbS5xdHkpfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoYWRkQWxsKTtcbiAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gdHguY29tcGxldGU7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGxvYWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RiUHJvbWlzZS50aGVuKGRiID0+IHtcbiAgICAgIHJldHVybiBkYi50cmFuc2FjdGlvbihDQVJUX1NUT1JFLCBSVylcbiAgICAgICAgLm9iamVjdFN0b3JlKENBUlRfU1RPUkUpXG4gICAgICAgIC5nZXRBbGwoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZSgpIHtcbi8vICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRoaXMuX2lkKTtcbiAgfVxuXG4gIC8vIFJldHVybnMgYSBwcm9taXNlIHdpdGggdGhlIHRvdGFsIG51bWJlciBvZiByZWNvcmRzIHNhdmVkXG4gIGNvdW50KCkge1xuICAgIHJldHVybiB0aGlzLl9kYlByb21pc2UudGhlbihkYiA9PiB7XG4gICAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKENBUlRfU1RPUkUpO1xuICAgICAgcmV0dXJuIHR4Lm9iamVjdFN0b3JlKENBUlRfU1RPUkUpLmNvdW50KCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBUZXN0aW5nIHVzZSBvbmx5LCB3aWxsIGNsb3NlIHRoZSBkYWJhc2UgYnV0IHJlbmRlcnMgdGhlIGFkYXB0b3IgdW51c2FibGVcbiAgX2Nsb3NlKCkge1xuICAgIHJldHVybiB0aGlzLl9kYlByb21pc2UudGhlbihkYiA9PiB7XG4gICAgICBsZXQgY2xvc2VQcm9taXNlID0gZGIuY2xvc2UoKTtcbiAgICAgIHRoaXMuX2RiUHJvbWlzZSA9IG51bGw7XG4gICAgICByZXR1cm4gY2xvc2VQcm9taXNlO1xuICAgIH0pO1xuICB9XG5cbiAgX29wZW4oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RiUHJvbWlzZSA9IGlkYi5vcGVuKHRoaXMuX2lkLCAxLCB1cGdyYWRlREIgPT4ge1xuICAgICAgdXBncmFkZURCLmNyZWF0ZU9iamVjdFN0b3JlKENBUlRfU1RPUkUsIHthdXRvSW5jcmVtZW50OiB0cnVlfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyB0ZXN0aW5nIGhvb2tzIHNvIHdlIGNhbiB0ZXN0IHcvbyB3cmVja2luZyB0aGUgc3RvcmVkIGRhdGFcbiAgc2V0IGtleSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5faWQpIHJldHVybjtcbiAgICB0aGlzLl9jbG9zZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5faWQgPSB2YWx1ZTtcbiAgICAgIHRoaXMuX29wZW4oKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldCBrZXkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgZ2V0IHN0b3JhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RiUHJvbWlzZTtcbiAgfVxufVxuIiwiLypcbkNvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuLypcbiAqIFNpbXBsZSBzZXJ2ZXIgZmV0Y2ggZnVuY3Rpb24gdGhhdCBvbmx5IHNlbmQgYSByZXF1ZXN0IHRvIC9jaGVja291dFxuICogYW5kIHJldHVybnMgYHRydWVgIG9yIHRocm93cyBhbiBleGNlcHRpb24uXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHNlbmRUb1NlcnZlcihkYXRhKSB7XG4gIHJldHVybiBmZXRjaCgnL2NoZWNrb3V0LycsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9LFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gIH0pLnRoZW4ocmVzID0+IHtcbiAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFBheW1lbnQgZmFpbHVyZSAoaWQgJHtyZXMuc3RhdHVzfSlgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xufVxuIiwiLypcbkNvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IHNlbmRUb1NlcnZlciBmcm9tICdtZXJjaGFudC1zZXJ2ZXInO1xuXG5jb25zdCBTSElQUElOR19PUFRJT05TID0ge1xuICB1czogW1xuICAgIHtcbiAgICAgIGlkOiAnc3RhbmRhcmQnLFxuICAgICAgbGFiZWw6ICdTdGFuZGFyZCBTaGlwcGluZycsXG4gICAgICBwcmljZTogMFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdleHByZXNzJyxcbiAgICAgIGxhYmVsOiAnRXhwcmVzcyBTaGlwcGluZycsXG4gICAgICBwcmljZTogMTBcbiAgICB9XG4gIF0sXG4gIGludGVybmF0aW9uYWw6IFtcbiAgICB7XG4gICAgICBpZDogJ2ludGVybmF0aW9uYWwnLFxuICAgICAgbGFiZWw6ICdJbnRlcm5hdGlvbmFsIFNoaXBwaW5nJyxcbiAgICAgIHByaWNlOiAxNVxuICAgIH1cbiAgXVxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGF5bWVudEFQSVdyYXBwZXIge1xuXG4gIC8qXG4gICogR2l2ZW4gYSBjYXJ0IHNldCB1cCB3aXRoIGFuIG9yZGVyLCBnZXRzIHBheW1lbnQgYXV0aG9yaXphdGlvbi5cbiAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gcGF5bWVudCBpcyBjb21wbGV0ZSwgdGhpc1xuICAqIGhhcyBhIGRhdGEgb2JqZWN0IHlvdSBjYW4gcGFzcyB0byB0aGUgYmFjay1lbmQgcGF5bWVudCBzZXJ2ZXIuXG4gICovXG4gIGNoZWNrb3V0KGNhcnQpIHtcbiAgICBsZXQgcmVxdWVzdCA9IHRoaXMuYnVpbGRQYXltZW50UmVxdWVzdChjYXJ0KTtcbiAgICBsZXQgcmVzcG9uc2U7XG4gICAgLy8gU2hvdyBVSSB0aGVuIGNvbnRpbnVlIHdpdGggdXNlciBwYXltZW50IGluZm9cblxuICAgIC8vIFRPRE8gUEFZLTUgLSBkaXNwbGF5IHRoZSBQYXltZW50UmVxdWVzdFxuICAgIHJldHVybiByZXF1ZXN0LnNob3coKVxuICAgIC50aGVuKHIgPT4ge1xuICAgICAgLy8gVGhlIFVJIHdpbGwgc2hvdyBhIHNwaW5uZXIgdG8gdGhlIHVzZXIgdW50aWxcbiAgICAgIC8vIGByZXF1ZXN0LmNvbXBsZXRlKClgIGlzIGNhbGxlZC5cbiAgICAgIHJlc3BvbnNlID0gcjtcbiAgICAgIGxldCBkYXRhID0gci50b0pTT04oKTtcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSlcbiAgICAudGhlbihkYXRhID0+IHtcbiAgICAgIHJldHVybiBzZW5kVG9TZXJ2ZXIoZGF0YSk7XG4gICAgfSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICByZXNwb25zZS5jb21wbGV0ZSgnc3VjY2VzcycpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgIH0pXG4gICAgLmNhdGNoKGUgPT4ge1xuICAgICAgaWYgKHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgIHJlc3BvbnNlLmNvbXBsZXRlKCdmYWlsJyk7XG4gICAgICB9IGVsc2UgaWYgKGUuY29kZSAhPT0gZS5BQk9SVF9FUlIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0pO1xufVxuXG4gIC8qXG4gICAqIENyZWF0ZXMgYSBQYXltZW50UmVxdWVzdCBvYmplY3QgaW5jbHVkaW5nIHRoZSBldmVudCBoYW5kbGVycyB1c2VkIHRvXG4gICAqIHVwZGF0ZSB0aGUgcGF5bWVudCBkZXRhaWxzIGFzIHRoZSB1c2VyIG1ha2VzIGNob2ljZXMuXG4gICAqL1xuICBidWlsZFBheW1lbnRSZXF1ZXN0KGNhcnQpIHtcbiAgICAvLyBTdXBwb3J0ZWQgcGF5bWVudCBpbnN0cnVtZW50c1xuICAgIGNvbnN0IHN1cHBvcnRlZEluc3RydW1lbnRzID0gW1xuICAgICAgLy8gVE9ETyBQQVktMyAtIGFkZCBhIGxpc3Qgb2YgYWNjZXB0ZWQgcGF5bWVudCBtZXRob2RzXG4gICAgICB7XG4gICAgICAgIHN1cHBvcnRlZE1ldGhvZHM6IFsnYmFzaWMtY2FyZCddLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VwcG9ydGVkTmV0d29ya3M6IFsndmlzYScsICdtYXN0ZXJjYXJkJywgJ2FtZXgnLFxuICAgICAgICAgICdqY2InLCAnZGluZXJzJywgJ2Rpc2NvdmVyJywgJ21pcicsICd1bmlvbnBheSddXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdO1xuXG4gICAgLy8gUGF5bWVudCBvcHRpb25zXG4gICAgY29uc3QgcGF5bWVudE9wdGlvbnMgPSB7XG5cbiAgICAgIC8vIFRPRE8gUEFZLTYuMSAtIGFsbG93IHNoaXBwaW5nIG9wdGlvbnNcbiAgICAgIHJlcXVlc3RTaGlwcGluZzogdHJ1ZSxcbiAgICAgIC8vIFRPRE8gUEFZLTggLSBBZGQgcGF5bWVudCBvcHRpb25zXG4gICAgICByZXF1ZXN0UGF5ZXJFbWFpbDogdHJ1ZSxcbiAgICAgIHJlcXVlc3RQYXllclBob25lOiB0cnVlLFxuICAgICAgcmVxdWVzdFBheWVyTmFtZTogdHJ1ZVxuXG4gICAgfTtcblxuICAgIGxldCBzaGlwcGluZ09wdGlvbnMgPSBbXTtcbiAgICBsZXQgc2VsZWN0ZWRPcHRpb24gPSBudWxsO1xuXG4gICAgbGV0IGRldGFpbHMgPSB0aGlzLmJ1aWxkUGF5bWVudERldGFpbHMoY2FydCwgc2hpcHBpbmdPcHRpb25zLCBzZWxlY3RlZE9wdGlvbik7XG5cbiAgICAvLyBUT0RPIFBBWS0yLjIgLSBpbml0aWFsaXplIHRoZSBQYXltZW50UmVxdWVzdCBvYmplY3RcbiAgICBsZXQgcmVxdWVzdCA9IG5ldyBQYXltZW50UmVxdWVzdChzdXBwb3J0ZWRJbnN0cnVtZW50cywgZGV0YWlscywgcGF5bWVudE9wdGlvbnMpO1xuXG4gICAgLy8gVE9ETyBQQVktNy4xIC0gYWRkIGBzaGlwcGluZ2FkZHJlc3NjaGFuZ2VgIGV2ZW50IGhhbmRsZXJcbiAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3NoaXBwaW5nYWRkcmVzc2NoYW5nZScsIGUgPT4ge1xuICAgICAgZS51cGRhdGVXaXRoKChfID0+IHtcbiAgICAgICAgLy8gR2V0IHRoZSBzaGlwcGluZyBvcHRpb25zIGFuZCBzZWxlY3QgdGhlIGxlYXN0IGV4cGVuc2l2ZVxuICAgICAgICBzaGlwcGluZ09wdGlvbnMgPSB0aGlzLm9wdGlvbnNGb3JDb3VudHJ5KHJlcXVlc3Quc2hpcHBpbmdBZGRyZXNzLmNvdW50cnkpO1xuICAgICAgICBzZWxlY3RlZE9wdGlvbiA9IHNoaXBwaW5nT3B0aW9uc1swXS5pZDtcbiAgICAgICAgbGV0IGRldGFpbHMgPSB0aGlzLmJ1aWxkUGF5bWVudERldGFpbHMoY2FydCwgc2hpcHBpbmdPcHRpb25zLCBzZWxlY3RlZE9wdGlvbik7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGV0YWlscyk7XG4gICAgICB9KSgpKTtcbiAgICB9KTtcbiAgICAvLyBUT0RPIFBBWS03LjIgLSBhZGQgYHNoaXBwaW5nb3B0aW9uY2hhbmdlYCBldmVudCBoYW5kbGVyXG4gICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdzaGlwcGluZ29wdGlvbmNoYW5nZScsIGUgPT4ge1xuICAgICAgZS51cGRhdGVXaXRoKChfID0+IHtcbiAgICAgICAgc2VsZWN0ZWRPcHRpb24gPSByZXF1ZXN0LnNoaXBwaW5nT3B0aW9uO1xuICAgICAgICBsZXQgZGV0YWlscyA9IHRoaXMuYnVpbGRQYXltZW50RGV0YWlscyhjYXJ0LCBzaGlwcGluZ09wdGlvbnMsIHNlbGVjdGVkT3B0aW9uKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXRhaWxzKTtcbiAgICAgIH0pKCkpO1xuICAgIH0pO1xuICAgIHJldHVybiByZXF1ZXN0O1xuICB9XG5cbiAgLypcbiAgICogQ3JlYXRlcyB0aGUgUGF5bWVudERldGFpbHMgZGljdGlvbmFyeSBpbnNpZGUgdGhlIFBheW1lbnRSZXF1ZXN0LlxuICAgKiBUaGlzIGNhbiBjaGFuZ2UgYXMgdGhlIHVzZXIgc2VsZWN0cyBzaGlwcGluZyBvcHRpb25zLlxuICAgKi9cbiAgYnVpbGRQYXltZW50RGV0YWlscyhjYXJ0LCBzaGlwcGluZ09wdGlvbnMsIHNoaXBwaW5nT3B0aW9uSWQpIHtcblxuICAgIC8vIFRPRE8gUEFZLTQuMiAtIGRlZmluZSB0aGUgZGlzcGxheSBpdGVtc1xuICAgIGxldCBkaXNwbGF5SXRlbXMgPSBjYXJ0LmNhcnQubWFwKGl0ZW0gPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGFiZWw6IGAke2l0ZW0uc2t1fTogJHtpdGVtLnF1YW50aXR5fXggUnAuICR7aXRlbS5wcmljZX1gLFxuICAgICAgICBhbW91bnQ6IHtjdXJyZW5jeTogJ0lEUicsIHZhbHVlOiBTdHJpbmcoaXRlbS50b3RhbCl9XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgbGV0IHRvdGFsID0gY2FydC50b3RhbDtcblxuICAgIC8vIFRPRE8gUEFZLTYuMyAtIGFsbG93IHNoaXBwaW5nIG9wdGlvbnNcbiAgICBsZXQgZGlzcGxheWVkU2hpcHBpbmdPcHRpb25zID0gW107XG4gICAgaWYgKHNoaXBwaW5nT3B0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBsZXQgc2VsZWN0ZWRPcHRpb24gPSBzaGlwcGluZ09wdGlvbnMuZmluZChvcHRpb24gPT4ge1xuICAgICAgICByZXR1cm4gb3B0aW9uLmlkID09PSBzaGlwcGluZ09wdGlvbklkO1xuICAgICAgfSk7XG4gICAgICBkaXNwbGF5ZWRTaGlwcGluZ09wdGlvbnMgPSBzaGlwcGluZ09wdGlvbnMubWFwKG9wdGlvbiA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IG9wdGlvbi5pZCxcbiAgICAgICAgICBsYWJlbDogb3B0aW9uLmxhYmVsLFxuICAgICAgICAgIGFtb3VudDoge2N1cnJlbmN5OiAnSURSJywgdmFsdWU6IFN0cmluZyhvcHRpb24ucHJpY2UpfSxcbiAgICAgICAgICBzZWxlY3RlZDogb3B0aW9uLmlkID09PSBzaGlwcGluZ09wdGlvbklkXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIGlmIChzZWxlY3RlZE9wdGlvbikgdG90YWwgKz0gc2VsZWN0ZWRPcHRpb24ucHJpY2U7XG4gICAgfVxuXG4gICAgbGV0IGRldGFpbHMgPSB7XG4gICAgICBkaXNwbGF5SXRlbXM6IGRpc3BsYXlJdGVtcyxcbiAgICAgIHRvdGFsOiB7XG4gICAgICBsYWJlbDogJ1RvdGFsIGR1ZScsXG4gICAgICBhbW91bnQ6IHtjdXJyZW5jeTogJ0lEUicsIHZhbHVlOiBTdHJpbmcodG90YWwpfVxuICAgICAgfSxcbiAgICAgIC8vIFRPRE8gUEFZLTYuMiAtIGFsbG93IHNoaXBwaW5nIG9wdGlvbnNcbiAgICAgIHNoaXBwaW5nT3B0aW9uczogZGlzcGxheWVkU2hpcHBpbmdPcHRpb25zXG4gICAgfTtcblxuICAgIHJldHVybiBkZXRhaWxzO1xuICB9XG5cbiAgLypcbiAgICogVXRpbGl0eSBmdW5jdGlvbiB0byBleHRyYWN0IHRoZSBjb3JyZWN0IHNoaXBwaW5nIG9wdGlvbnMgZm9yIGEgY291bnRyeS5cbiAgICovXG4gIG9wdGlvbnNGb3JDb3VudHJ5KGNvdW50cnkpIHtcbiAgICBjb3VudHJ5ID0gY291bnRyeS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICghY291bnRyeSB8fCAhU0hJUFBJTkdfT1BUSU9OUy5oYXNPd25Qcm9wZXJ0eShjb3VudHJ5KSkge1xuICAgICAgY291bnRyeSA9ICdpbnRlcm5hdGlvbmFsJztcbiAgICB9XG4gICAgbGV0IG9wdGlvbnMgPSBTSElQUElOR19PUFRJT05TW2NvdW50cnldO1xuICAgIC8vIFNvcnQgYnkgcHJpY2UsIGxvd2VzdCBmaXJzdFxuICAgIG9wdGlvbnMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgcmV0dXJuIGEucHJpY2UgLSBiLnByaWNlO1xuICAgIH0pO1xuICAgIHJldHVybiBvcHRpb25zO1xuICB9XG5cbn1cbiIsIi8qXG5Db3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBWaWV3IGZyb20gJ3ZpZXcnO1xuaW1wb3J0IHNlbmRUb1NlcnZlciBmcm9tICdtZXJjaGFudC1zZXJ2ZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYXltZW50Rm9ybSBleHRlbmRzIFZpZXcge1xuXG4gIGNvbnN0cnVjdG9yKGNhcnQsIGNvbmZpcm1hdGlvblZpZXcsIGNvbnRhaW5lcklkID0gJ3BheW1lbnQnKSB7XG4gICAgc3VwZXIoY29udGFpbmVySWQpO1xuICAgIHRoaXMuX2NoZWNrb3V0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXltZW50X2Zvcm0nKTtcbiAgICB0aGlzLl9jYXJ0ID0gY2FydDtcbiAgICB0aGlzLl9jb25maXJtYXRpb25WaWV3ID0gY29uZmlybWF0aW9uVmlldztcbiAgICB0aGlzLl9wcm9taXNlID0gbnVsbDtcbiAgfVxuXG4gIC8qXG4gICAqIFBlcmZvcm1zIHRoZSBjaGVja291dCB1c2luZyB0aGUgZm9ybS4gUmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuXG4gICAqIHRoZSB1c2VyIGNoZWNrcyBvdXQuXG4gICAqL1xuICBjaGVja291dCgpIHtcbiAgICAvLyBUT0RPIGhvdyBkbyB3ZSBoYW5kbGUgY2FydCBhYmFuZG9ubWVudD9cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLl9wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdGhpcy5fY2hlY2tvdXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIHRlbXAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGRhdGEgPSBuZXcgRm9ybURhdGEoZXZlbnQudGFyZ2V0KTtcbiAgICAgICAgc2VsZi5fc2hvd1JlcXVlc3QoZGF0YSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgICAgICAgICAudGhlbihzZW5kVG9TZXJ2ZXIpXG4gICAgICAgICAgLnRoZW4oanNvbiA9PiB7XG4gICAgICAgICAgICBzZWxmLl9zaG93UmVzcG9uc2UoanNvbik7XG4gICAgICAgICAgICByZXNvbHZlKGpzb24pO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKGUgPT4gcmVqZWN0KGUpKVxuICAgICAgICAgIC50aGVuKCgpID0+IHNlbGYuX2NoZWNrb3V0Rm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0ZW1wKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5fcHJvbWlzZTtcbiAgfVxuXG4gIGFib3J0KCkge1xuICAgIHRoaXMuX3Byb21pc2UucmVqZWN0KCdhYm9ydGVkJyk7XG4gIH1cblxuICBfc2hvd1JlcXVlc3QoZm9ybURhdGEpIHtcbiAgICBpZiAodGhpcy5fY29uZmlybWF0aW9uVmlldykge1xuICAgICAgdGhpcy5fY29uZmlybWF0aW9uVmlldy5yZXF1ZXN0RGF0YSA9IHRoaXMuX3RvSlNPTihmb3JtRGF0YSk7XG4gICAgfVxuICB9XG5cbiAgX3Nob3dSZXNwb25zZShqc29uKSB7XG4gICAgaWYgKHRoaXMuX2NvbmZpcm1hdGlvblZpZXcpIHtcbiAgICAgIHRoaXMuX2NvbmZpcm1hdGlvblZpZXcucmVzcG9uc2VEYXRhID0ganNvbjtcbiAgICB9XG4gIH1cblxuICBfdG9KU09OKGZvcm1EYXRhKSB7XG4gICAgbGV0IG9iaiA9IHt9O1xuICAgIGZvciAobGV0IGVudHJ5IG9mIGZvcm1EYXRhKSB7XG4gICAgICBvYmpbZW50cnkua2V5XSA9IGVudHJ5LnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgfVxuXG59XG4iLCIvKlxuQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG4vL2pzaGludCBlc3ZlcnNpb246IDZcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZHVjdCB7XG5cbiAgY29uc3RydWN0b3IgKHNrdSwgdGl0bGUsIHByaWNlLCBpbWFnZSwgZGVzY3JpcHRpb249JycpIHtcbiAgICB0aGlzLl9za3UgPSBza3U7XG4gICAgdGhpcy5fdGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLl9wcmljZSA9IHByaWNlO1xuICAgIHRoaXMuX2ltYWdlID0gaW1hZ2U7XG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgfVxuXG4gIGdldCBza3UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3NrdTtcbiAgfVxuXG4gIGdldCB0aXRsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fdGl0bGU7XG4gIH1cblxuICBnZXQgcHJpY2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ByaWNlO1xuICB9XG5cbiAgZ2V0IGltYWdlKCkge1xuICAgIHJldHVybiB0aGlzLl9pbWFnZTtcbiAgfVxuXG4gIGdldCBkZXNjcmlwdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5fZGVzY3JpcHRpb247XG4gIH1cblxufVxuIiwiLypcbkNvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cbmltcG9ydCBQcm9kdWN0IGZyb20gJ3Byb2R1Y3QnO1xuXG4vLyAgIGNvbnN0cnVjdG9yIChza3UsIHRpdGxlLCBwcmljZSwgaW1hZ2UsIGRlc2NyaXB0aW9uPScnKSB7XG5cbi8vIE5vcm1hbGx5IHlvdSB3b3VsZCBnZXQgdGhlc2UgZnJvbSBhIHNlcnZlclxuZXhwb3J0IGNvbnN0IHByb2R1Y3RzID0gW1xuICBuZXcgUHJvZHVjdCgnQmF0aWsxJywgJ0JhdGlrIDEnLCAyNTAwMCwgJ2JhdGlrMS5qcGcnLFxuICAgICdJbmkgYWRhbGFoIGJhdGlrIHlhbmcgcGVydGFtYSBidWthbiBrZWR1YS4nKSxcbiAgbmV3IFByb2R1Y3QoJ0JhdGlrMicsICdCYXRpayAyJywgMzMwMDAsICdiYXRpazIuanBnJyxcbiAgICAnWWFuZyBpbmkgbmFtYW55YSBiYXRpayBrZWR1YSBidWthbiBvcmFuZyBrZWR1YS4nKSxcbiAgbmV3IFByb2R1Y3QoJ0JhdGlrMycsICdCYXRpayAzJywgMjIwMDAsICdiYXRpazMuanBnJyxcbiAgICAnSW5pIGJhdGlrIHlhbmcga2V0aWdhIHdhbGF1IHNlbXVhIHRpZGFrIHN1a2EgbWVuamFkaSB5YW5nIGtldGlnYS4nKSxcbiAgbmV3IFByb2R1Y3QoJ0JhdGlrNCcsICdCYXRpayA0JywgNDUwMDAsICdiYXRpazQuanBnJyxcbiAgICAnQmF0aWsgNCBzZXJpbmcgZGlzZWJ1dCBqdWdhIHlhbmcga2VlbXBhdCBtZXNraSB0YWsgZGlhbmdnYXAuJyksXG4gIG5ldyBQcm9kdWN0KCdCYXRpazUnLCAnQmF0aWsgNScsIDUwMDAwLCAnYmF0aWs1LmpwZycsXG4gICAgJ1NlYmFnYWkgeWFuZyBrZWxpbWEgYmF0aWsgaW5pIGtvbnNpc3RlbiBtZW5qYWRpIHNlY3JldCBhZG1pcmUuJyksXG4gIG5ldyBQcm9kdWN0KCdCYXRpazYnLCAnQmF0aWsgNicsIDYwMDAwLCAnYmF0aWs2LmpwZycsXG4gICAgJ0luaSBiYXRpayB5YW5nIGtlZW5hbSBtZXNraSB0YWsgcHVueWEgcGVuZ2FsYW1hbiBtZW5qYWxpbiBodWJ1bmdhbi4nKSxcbiAgbmV3IFByb2R1Y3QoJ0JhdGlrNycsICdCYXRpayA3JywgNjUwMDAsICdiYXRpazcuanBnJyxcbiAgICAnQmF0aWsgaW5pIEtldHVqdWggZGVuZ2FuIHNlbXVhIGtlcHV0dXNhbm11LicpLFxuICBuZXcgUHJvZHVjdCgnQmF0aWs4JywgJ0JhdGlrIDgnLCA3MDAwMCwgJ2JhdGlrOC5qcGcnLFxuICAgICdJbmkgYmF0aWsga2VkZWxhcGFuIHdhbGF1IGJ1a2FuIHlhbmcgcGVydGFtYSBzZW1vZ2EgaW5pIHlhbmcgdGVyYmFpaycpLFxuICBuZXcgUHJvZHVjdCgnQmF0aWs5JywgJ0JhdGlrIDknLCAyMDAwMDAsICdiYXRpazkuanBnJyxcbiAgICAnTWVza2kgaW5pIG1lcnVwYWthbiBiYXRpayB0ZXJtYWhhbCBuYW11biBrdXBhc3Rpa2FuIGthbXUgdGVyYWtoaXIgeWFuZyBtZW1pbGlraWt1Jylcbl07XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kUHJvZHVjdChza3UsIHNlYXJjaFJhbmdlID0gcHJvZHVjdHMpIHtcbiAgcmV0dXJuIHNlYXJjaFJhbmdlLmZpbmQocHJvZHVjdCA9PiBwcm9kdWN0LnNrdSA9PT0gc2t1KTtcbn1cbiIsIi8qXG5Db3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBWaWV3IGZyb20gJ3ZpZXcnO1xuaW1wb3J0IHtwcm9kdWN0cywgZmluZFByb2R1Y3R9IGZyb20gJ3Byb2R1Y3RzJztcbmltcG9ydCBzaG93VG9hc3QgZnJvbSAnc25hY2tiYXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTaG9wVmlldyBleHRlbmRzIFZpZXcge1xuXG4gIGNvbnN0cnVjdG9yKGNhcnQsIHByb2R1Y3RTZWxlY3Rpb24gPSBwcm9kdWN0cywgY29udGFpbmVySWQgPSAnc2hvcCcpIHtcbiAgICBzdXBlcihjb250YWluZXJJZCwgdHJ1ZSk7XG4gICAgdGhpcy5fY2FydCA9IGNhcnQ7XG4gICAgdGhpcy5fcHJvZHVjdHMgPSBwcm9kdWN0U2VsZWN0aW9uO1xuICAgIHRoaXMuX2VsZW1lbnQgPSAnZGl2JztcbiAgICB0aGlzLl9lbGVtZW50Q2xhc3MgPSAncHJvZHVjdCc7XG4gICAgdGhpcy5fYWRkSGFuZGxlciA9IG51bGw7XG4gIH1cblxuICBpbnN0YWxsKCkge1xuICAgIC8vIENhcHR1cmUgYWRkIGV2ZW50cyAoY2xpY2tzKSBhcyB0aGV5IGJ1YmJsZSB1cC4gT25seSBhZGQgb25jZS5cbiAgICB0aGlzLl9hZGRIYW5kbGVyID0gdGhpcy5faGFuZGxlUHJvZHVjdENsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fYWRkSGFuZGxlciwgZmFsc2UpO1xuICB9XG5cbiAgcmVuZGVyICgpIHtcbiAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gJyc7IC8vIHJlbW92ZSBhbGwgY2hpbGRyZW5cbiAgICBmb3IgKGxldCBwcm9kdWN0IG9mIHRoaXMuX3Byb2R1Y3RzKSB7XG4gICAgICBsZXQgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHBsYWNlaG9sZGVyLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwibWRsLWNlbGwgbWRsLWNhcmQgbWRsLXNoYWRvdy0tNGRwIHBvcnRmb2xpby1jYXJkIHByb2R1Y3RcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm1kbC1jYXJkX19tZWRpYVwiPlxuICAgICAgICAgIDxpbWcgY2xhc3M9XCJhcnRpY2xlLWltYWdlXCIgc3JjPVwiIGltYWdlcy9wcm9kdWN0cy8ke3Byb2R1Y3QuaW1hZ2V9XCIgYm9yZGVyPVwiMFwiIGFsdD1cIlwiPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm1kbC1jYXJkX190aXRsZVwiPlxuICAgICAgICAgIDxoMiBjbGFzcz1cIm1kbC1jYXJkX190aXRsZS10ZXh0XCI+JHtwcm9kdWN0LnRpdGxlfTwvaDI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwibWRsLWNhcmRfX3N1cHBvcnRpbmctdGV4dFwiPlxuICAgICAgICAgICR7cHJvZHVjdC5kZXNjcmlwdGlvbn1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJtZGwtY2FyZF9fYWN0aW9ucyBtZGwtY2FyZC0tYm9yZGVyXCI+XG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cIm1kbC1idXR0b24gbWRsLWJ1dHRvbi0tY29sb3JlZCBtZGwtanMtYnV0dG9uXG4gICAgICAgICAgICBtZGwtanMtcmlwcGxlLWVmZmVjdCBtZGwtYnV0dG9uLS1hY2NlbnQgYWRkLXRvLWNhcnRcIlxuICAgICAgICAgICAgZGF0YS1za3U9XCIke3Byb2R1Y3Quc2t1fVwiPlxuICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmFkZF9zaG9wcGluZ19jYXJ0PC9pPkFkZCB0byBDYXJ0XG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+YDtcbiAgICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmRDaGlsZChwbGFjZWhvbGRlci5maXJzdEVsZW1lbnRDaGlsZCk7IC8vIFdBUk46IG5vIGllOFxuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVQcm9kdWN0Q2xpY2soZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIC8vIE1ETCBpbnNlcnRzIGFuIGFuaW1hdGVkIHNwYW4gYXMgYSBjaGlsZCBvZiB0aGUgYnV0dG9uOyBpdCBnZXRzIHRoZSBjbGljay5cbiAgICAvLyBXZSBtYXkgbmVlZCB0byBsb29rIGF0IHRoZSBwYXJlbnQgdG8gZmluZCB0aGUgYnV0dG9uLlxuICAgIGxldCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgaWYgKCF0YXJnZXQgfHwgdGFyZ2V0ID09IHRoaXMuX2NvbnRhaW5lcikgcmV0dXJuO1xuICAgIHdoaWxlICh0YXJnZXQubm9kZU5hbWUgIT0gJ0JVVFRPTicpIHtcbiAgICAgIGlmICghdGFyZ2V0LnBhcmVudE5vZGUpIGJyZWFrO1xuICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgfVxuICAgIGlmICghdGFyZ2V0LmRhdGFzZXQpIHJldHVybjtcbiAgICB2YXIgc2t1ID0gdGFyZ2V0LmRhdGFzZXQuc2t1O1xuICAgIGlmICghc2t1KSB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCBmaW5kIHNrdSwgZGF0YS0gYXR0cnMgbm90IHN1cHBvcnRlZD8nKTtcbiAgICB2YXIgcHJvZHVjdCA9IGZpbmRQcm9kdWN0KHNrdSwgdGhpcy5fcHJvZHVjdHMpO1xuICAgIHRoaXMuX2NhcnQuYWRkKHByb2R1Y3QpO1xuICAgIHRoaXMuX3Nob3dDb25maXJtYXRpb24ocHJvZHVjdCk7XG4gIH1cblxuICBfc2hvd0NvbmZpcm1hdGlvbihwcm9kdWN0KSB7XG4gICAgc2hvd1RvYXN0KGAke3Byb2R1Y3Quc2t1fSBhZGRlZCB0byBjYXJ0YCk7XG4gIH1cblxuICAvLyB1dGlsaXR5IGZvciB1bml0IHRlc3RpbmcgKHVzZWQgaW4gY291bnRpbmcgdGhlIG51bWJlciBvZiBlbGVtZW50cylcbiAgZ2V0IGl0ZW1TZWxlY3RvcigpIHtcbiAgICByZXR1cm4gYCR7dGhpcy5fZWxlbWVudH0uJHt0aGlzLl9lbGVtZW50Q2xhc3N9YDtcbiAgfVxuXG59XG4iLCIvKlxuQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG4vL2pzaGludCBlc3ZlcnNpb246IDZcblxuLy8gUG9wIHVwIGEgdXNlciBub3RpZmljYXRpb25cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHNob3dUb2FzdChtZXNzYWdlKSB7XG4gIHZhciBub3RpZmljYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25hY2tiYXInKTtcbiAgaWYgKG5vdGlmaWNhdGlvbiAmJiAoJ01hdGVyaWFsU25hY2tiYXInIGluIG5vdGlmaWNhdGlvbikpIHtcbiAgICBub3RpZmljYXRpb24uTWF0ZXJpYWxTbmFja2Jhci5zaG93U25hY2tiYXIoe21lc3NhZ2U6IChtZXNzYWdlKX0pO1xuICB9XG59XG4iLCIvKlxuQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG4vL2pzaGludCBlc3ZlcnNpb246IDZcbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlTG9jYXRpb25IYXNoKGhhc2gsIGJhc2VVcmwgPSB3aW5kb3cubG9jYXRpb24pIHtcbiAgbGV0IHVybCA9IHVybFdpdGhIYXNoKGhhc2gsIGJhc2VVcmwpO1xuICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7fSwgXCJcIiwgdXJsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1c2hMb2NhdGlvbkhhc2goaGFzaCwgYmFzZVVybCA9IHdpbmRvdy5sb2NhdGlvbikge1xuICB3aW5kb3cubG9jYXRpb24gPSB1cmxXaXRoSGFzaChoYXNoLCBiYXNlVXJsKTtcbn1cblxuZnVuY3Rpb24gdXJsV2l0aEhhc2goaGFzaCwgYmFzZVVybCkge1xuICBsZXQgdXJsID0gYmFzZVVybC50b1N0cmluZygpO1xuICBsZXQgaW5kZXggPSB1cmwuaW5kZXhPZignIycpO1xuICBpZiAoaW5kZXggPj0gMCkgdXJsID0gdXJsLnN1YnN0cmluZygwLCBpbmRleCk7XG4gIHJldHVybiB1cmwgKyAgJyMnICsgaGFzaDtcbn07XG4iLCIvKlxuQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWaWV3IHtcbiAgY29uc3RydWN0b3IoY29udGFpbmVySWQsIHJlbmRlckJlZm9yZVZpc2libGUgPSBmYWxzZSkge1xuICAgIHRoaXMuX2NvbnRhaW5lcklkID0gY29udGFpbmVySWQ7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5fY29udGFpbmVySWQpO1xuICAgIHRoaXMuX25lZWRzUmVuZGVyID0gcmVuZGVyQmVmb3JlVmlzaWJsZTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICAvLyBvdmVycmlkZSB0aGlzXG4gIH1cblxuICBzZXQgdmlzaWJsZSh2aXMpIHtcbiAgICBpZiAodmlzICYmICF0aGlzLnZpc2libGUgJiYgdGhpcy5fbmVlZHNSZW5kZXIpIHtcbiAgICAgIC8vIGJlY29taW5nIHZpc2libGUsIHVwZGF0ZVxuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG4gICAgaWYgKHZpcykge1xuICAgICAgdGhpcy5fY29udGFpbmVyLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIGdldCB2aXNpYmxlKCkge1xuICAgIHJldHVybiAhdGhpcy5fY29udGFpbmVyLmhhc0F0dHJpYnV0ZSgnaGlkZGVuJyk7XG4gIH1cblxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcmVxdWVzdDtcbiAgICB2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdCA9IG9ialttZXRob2RdLmFwcGx5KG9iaiwgYXJncyk7XG4gICAgICBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9KTtcblxuICAgIHAucmVxdWVzdCA9IHJlcXVlc3Q7XG4gICAgcmV0dXJuIHA7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XG4gICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIHAucmVxdWVzdCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVByb3BlcnRpZXMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlDbGFzcy5wcm90b3R5cGUsIHByb3AsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICB0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXS5hcHBseSh0aGlzW3RhcmdldFByb3BdLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBJbmRleChpbmRleCkge1xuICAgIHRoaXMuX2luZGV4ID0gaW5kZXg7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoSW5kZXgsICdfaW5kZXgnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnbXVsdGlFbnRyeScsXG4gICAgJ3VuaXF1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ2dldCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XG4gICAgdGhpcy5fY3Vyc29yID0gY3Vyc29yO1xuICAgIHRoaXMuX3JlcXVlc3QgPSByZXF1ZXN0O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEN1cnNvciwgJ19jdXJzb3InLCBbXG4gICAgJ2RpcmVjdGlvbicsXG4gICAgJ2tleScsXG4gICAgJ3ByaW1hcnlLZXknLFxuICAgICd2YWx1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXG4gICAgJ3VwZGF0ZScsXG4gICAgJ2RlbGV0ZSdcbiAgXSk7XG5cbiAgLy8gcHJveHkgJ25leHQnIG1ldGhvZHNcbiAgWydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgIGlmICghKG1ldGhvZE5hbWUgaW4gSURCQ3Vyc29yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICBDdXJzb3IucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgY3Vyc29yID0gdGhpcztcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QoY3Vyc29yLl9yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XG4gICAgdGhpcy5fc3RvcmUgPSBzdG9yZTtcbiAgfVxuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5jcmVhdGVJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuY3JlYXRlSW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdpbmRleE5hbWVzJyxcbiAgICAnYXV0b0luY3JlbWVudCdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ3B1dCcsXG4gICAgJ2FkZCcsXG4gICAgJ2RlbGV0ZScsXG4gICAgJ2NsZWFyJyxcbiAgICAnZ2V0JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ2RlbGV0ZUluZGV4J1xuICBdKTtcblxuICBmdW5jdGlvbiBUcmFuc2FjdGlvbihpZGJUcmFuc2FjdGlvbikge1xuICAgIHRoaXMuX3R4ID0gaWRiVHJhbnNhY3Rpb247XG4gICAgdGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBUcmFuc2FjdGlvbi5wcm90b3R5cGUub2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX3R4Lm9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX3R4LCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVHJhbnNhY3Rpb24sICdfdHgnLCBbXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnLFxuICAgICdtb2RlJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xuICAgICdhYm9ydCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVXBncmFkZURCKGRiLCBvbGRWZXJzaW9uLCB0cmFuc2FjdGlvbikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gICAgdGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcbiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTtcbiAgfVxuXG4gIFVwZ3JhZGVEQi5wcm90b3R5cGUuY3JlYXRlT2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdkZWxldGVPYmplY3RTdG9yZScsXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICBmdW5jdGlvbiBEQihkYikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gIH1cblxuICBEQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuX2RiLnRyYW5zYWN0aW9uLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKERCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIC8vIEFkZCBjdXJzb3IgaXRlcmF0b3JzXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcbiAgWydvcGVuQ3Vyc29yJywgJ29wZW5LZXlDdXJzb3InXS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmNOYW1lKSB7XG4gICAgW09iamVjdFN0b3JlLCBJbmRleF0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgICAgQ29uc3RydWN0b3IucHJvdG90eXBlW2Z1bmNOYW1lLnJlcGxhY2UoJ29wZW4nLCAnaXRlcmF0ZScpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJnc1thcmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgbmF0aXZlT2JqZWN0ID0gdGhpcy5fc3RvcmUgfHwgdGhpcy5faW5kZXg7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmF0aXZlT2JqZWN0W2Z1bmNOYW1lXS5hcHBseShuYXRpdmVPYmplY3QsIGFyZ3Muc2xpY2UoMCwgLTEpKTtcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBwb2x5ZmlsbCBnZXRBbGxcbiAgW0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgIGlmIChDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsKSByZXR1cm47XG4gICAgQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uKHF1ZXJ5LCBjb3VudCkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICBpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbihjdXJzb3IpIHtcbiAgICAgICAgICBpZiAoIWN1cnNvcikge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcblxuICAgICAgICAgIGlmIChjb3VudCAhPT0gdW5kZWZpbmVkICYmIGl0ZW1zLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIHZhciBleHAgPSB7XG4gICAgb3BlbjogZnVuY3Rpb24obmFtZSwgdmVyc2lvbiwgdXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ29wZW4nLCBbbmFtZSwgdmVyc2lvbl0pO1xuICAgICAgdmFyIHJlcXVlc3QgPSBwLnJlcXVlc3Q7XG5cbiAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgICAgIHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEQihkYik7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBleHA7XG4gIH1cbiAgZWxzZSB7XG4gICAgc2VsZi5pZGIgPSBleHA7XG4gIH1cbn0oKSk7XG4iXX0=
